"use strict";var e=require("zlib"),t=require("crypto");require("vm");var n=require("path"),r=require("fs"),i=require("json5"),o=require("got");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var c=s(t),u=s(n),f=s(r),l=s(i),d=a(o),p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g=function(e){return e&&e.Math==Math&&e},m=g("object"==typeof globalThis&&globalThis)||g("object"==typeof window&&window)||g("object"==typeof self&&self)||g("object"==typeof p&&p)||function(){return this}()||Function("return this")(),h={},y=function(e){try{return!!e()}catch(e){return!0}},_=!y((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),v=!y((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),w=v,b=Function.prototype.call,$=w?b.bind(b):function(){return b.apply(b,arguments)},T={},S={}.propertyIsEnumerable,O=Object.getOwnPropertyDescriptor,C=O&&!S.call({1:2},1);T.f=C?function(e){var t=O(this,e);return!!t&&t.enumerable}:S;var k,I,E=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},P=v,x=Function.prototype,j=x.bind,L=x.call,R=P&&j.bind(L,L),A=P?function(e){return e&&R(e)}:function(e){return e&&function(){return L.apply(e,arguments)}},N=A,U=N({}.toString),D=N("".slice),B=function(e){return D(U(e),8,-1)},F=y,z=B,M=Object,q=A("".split),G=F((function(){return!M("z").propertyIsEnumerable(0)}))?function(e){return"String"==z(e)?q(e,""):M(e)}:M,J=TypeError,K=function(e){if(null==e)throw J("Can't call method on "+e);return e},H=G,W=K,Y=function(e){return H(W(e))},Q=function(e){return"function"==typeof e},V=Q,X=function(e){return"object"==typeof e?null!==e:V(e)},Z=m,ee=Q,te=function(e){return ee(e)?e:void 0},ne=function(e,t){return arguments.length<2?te(Z[e]):Z[e]&&Z[e][t]},re=A({}.isPrototypeOf),ie=m,oe=ne("navigator","userAgent")||"",ae=ie.process,se=ie.Deno,ce=ae&&ae.versions||se&&se.version,ue=ce&&ce.v8;ue&&(I=(k=ue.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!I&&oe&&(!(k=oe.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=oe.match(/Chrome\/(\d+)/))&&(I=+k[1]);var fe=I,le=y,de=!!Object.getOwnPropertySymbols&&!le((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&fe&&fe<41})),pe=de&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=ne,me=Q,he=re,ye=Object,_e=pe?function(e){return"symbol"==typeof e}:function(e){var t=ge("Symbol");return me(t)&&he(t.prototype,ye(e))},ve=String,we=function(e){try{return ve(e)}catch(e){return"Object"}},be=Q,$e=we,Te=TypeError,Se=function(e){if(be(e))return e;throw Te($e(e)+" is not a function")},Oe=Se,Ce=function(e,t){var n=e[t];return null==n?void 0:Oe(n)},ke=$,Ie=Q,Ee=X,Pe=TypeError,xe={exports:{}},je=m,Le=Object.defineProperty,Re=function(e,t){try{Le(je,e,{value:t,configurable:!0,writable:!0})}catch(n){je[e]=t}return t},Ae=Re,Ne=m["__core-js_shared__"]||Ae("__core-js_shared__",{}),Ue=Ne;(xe.exports=function(e,t){return Ue[e]||(Ue[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.23.3",mode:"global",copyright:"¬© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"});var De=K,Be=Object,Fe=function(e){return Be(De(e))},ze=Fe,Me=A({}.hasOwnProperty),qe=Object.hasOwn||function(e,t){return Me(ze(e),t)},Ge=A,Je=0,Ke=Math.random(),He=Ge(1..toString),We=function(e){return"Symbol("+(void 0===e?"":e)+")_"+He(++Je+Ke,36)},Ye=m,Qe=xe.exports,Ve=qe,Xe=We,Ze=de,et=pe,tt=Qe("wks"),nt=Ye.Symbol,rt=nt&&nt.for,it=et?nt:nt&&nt.withoutSetter||Xe,ot=function(e){if(!Ve(tt,e)||!Ze&&"string"!=typeof tt[e]){var t="Symbol."+e;Ze&&Ve(nt,e)?tt[e]=nt[e]:tt[e]=et&&rt?rt(t):it(t)}return tt[e]},at=$,st=X,ct=_e,ut=Ce,ft=function(e,t){var n,r;if("string"===t&&Ie(n=e.toString)&&!Ee(r=ke(n,e)))return r;if(Ie(n=e.valueOf)&&!Ee(r=ke(n,e)))return r;if("string"!==t&&Ie(n=e.toString)&&!Ee(r=ke(n,e)))return r;throw Pe("Can't convert object to primitive value")},lt=TypeError,dt=ot("toPrimitive"),pt=function(e,t){if(!st(e)||ct(e))return e;var n,r=ut(e,dt);if(r){if(void 0===t&&(t="default"),n=at(r,e,t),!st(n)||ct(n))return n;throw lt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ft(e,t)},gt=_e,mt=function(e){var t=pt(e,"string");return gt(t)?t:t+""},ht=X,yt=m.document,_t=ht(yt)&&ht(yt.createElement),vt=function(e){return _t?yt.createElement(e):{}},wt=vt,bt=!_&&!y((function(){return 7!=Object.defineProperty(wt("div"),"a",{get:function(){return 7}}).a})),$t=_,Tt=$,St=T,Ot=E,Ct=Y,kt=mt,It=qe,Et=bt,Pt=Object.getOwnPropertyDescriptor;h.f=$t?Pt:function(e,t){if(e=Ct(e),t=kt(t),Et)try{return Pt(e,t)}catch(e){}if(It(e,t))return Ot(!Tt(St.f,e,t),e[t])};var xt={},jt=_&&y((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Lt=X,Rt=String,At=TypeError,Nt=function(e){if(Lt(e))return e;throw At(Rt(e)+" is not an object")},Ut=_,Dt=bt,Bt=jt,Ft=Nt,zt=mt,Mt=TypeError,qt=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor;xt.f=Ut?Bt?function(e,t,n){if(Ft(e),t=zt(t),Ft(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=Gt(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return qt(e,t,n)}:qt:function(e,t,n){if(Ft(e),t=zt(t),Ft(n),Dt)try{return qt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Mt("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Jt=xt,Kt=E,Ht=_?function(e,t,n){return Jt.f(e,t,Kt(1,n))}:function(e,t,n){return e[t]=n,e},Wt={exports:{}},Yt=_,Qt=qe,Vt=Function.prototype,Xt=Yt&&Object.getOwnPropertyDescriptor,Zt=Qt(Vt,"name"),en={EXISTS:Zt,PROPER:Zt&&"something"===function(){}.name,CONFIGURABLE:Zt&&(!Yt||Yt&&Xt(Vt,"name").configurable)},tn=Q,nn=Ne,rn=A(Function.toString);tn(nn.inspectSource)||(nn.inspectSource=function(e){return rn(e)});var on,an,sn,cn=nn.inspectSource,un=Q,fn=cn,ln=m.WeakMap,dn=un(ln)&&/native code/.test(fn(ln)),pn=xe.exports,gn=We,mn=pn("keys"),hn=function(e){return mn[e]||(mn[e]=gn(e))},yn={},_n=dn,vn=m,wn=A,bn=X,$n=Ht,Tn=qe,Sn=Ne,On=hn,Cn=yn,kn=vn.TypeError,In=vn.WeakMap;if(_n||Sn.state){var En=Sn.state||(Sn.state=new In),Pn=wn(En.get),xn=wn(En.has),jn=wn(En.set);on=function(e,t){if(xn(En,e))throw new kn("Object already initialized");return t.facade=e,jn(En,e,t),t},an=function(e){return Pn(En,e)||{}},sn=function(e){return xn(En,e)}}else{var Ln=On("state");Cn[Ln]=!0,on=function(e,t){if(Tn(e,Ln))throw new kn("Object already initialized");return t.facade=e,$n(e,Ln,t),t},an=function(e){return Tn(e,Ln)?e[Ln]:{}},sn=function(e){return Tn(e,Ln)}}var Rn={set:on,get:an,has:sn,enforce:function(e){return sn(e)?an(e):on(e,{})},getterFor:function(e){return function(t){var n;if(!bn(t)||(n=an(t)).type!==e)throw kn("Incompatible receiver, "+e+" required");return n}}},An=y,Nn=Q,Un=qe,Dn=_,Bn=en.CONFIGURABLE,Fn=cn,zn=Rn.enforce,Mn=Rn.get,qn=Object.defineProperty,Gn=Dn&&!An((function(){return 8!==qn((function(){}),"length",{value:8}).length})),Jn=String(String).split("String"),Kn=Wt.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Un(e,"name")||Bn&&e.name!==t)&&(Dn?qn(e,"name",{value:t,configurable:!0}):e.name=t),Gn&&n&&Un(n,"arity")&&e.length!==n.arity&&qn(e,"length",{value:n.arity});try{n&&Un(n,"constructor")&&n.constructor?Dn&&qn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=zn(e);return Un(r,"source")||(r.source=Jn.join("string"==typeof t?t:"")),e};Function.prototype.toString=Kn((function(){return Nn(this)&&Mn(this).source||Fn(this)}),"toString");var Hn=Q,Wn=xt,Yn=Wt.exports,Qn=Re,Vn={},Xn=Math.ceil,Zn=Math.floor,er=Math.trunc||function(e){var t=+e;return(t>0?Zn:Xn)(t)},tr=function(e){var t=+e;return t!=t||0===t?0:er(t)},nr=tr,rr=Math.max,ir=Math.min,or=tr,ar=Math.min,sr=function(e){return e>0?ar(or(e),9007199254740991):0},cr=function(e){return sr(e.length)},ur=Y,fr=function(e,t){var n=nr(e);return n<0?rr(n+t,0):ir(n,t)},lr=cr,dr=function(e){return function(t,n,r){var i,o=ur(t),a=lr(o),s=fr(r,a);if(e&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},pr={includes:dr(!0),indexOf:dr(!1)},gr=qe,mr=Y,hr=pr.indexOf,yr=yn,_r=A([].push),vr=function(e,t){var n,r=mr(e),i=0,o=[];for(n in r)!gr(yr,n)&&gr(r,n)&&_r(o,n);for(;t.length>i;)gr(r,n=t[i++])&&(~hr(o,n)||_r(o,n));return o},wr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],br=vr,$r=wr.concat("length","prototype");Vn.f=Object.getOwnPropertyNames||function(e){return br(e,$r)};var Tr={};Tr.f=Object.getOwnPropertySymbols;var Sr=ne,Or=Vn,Cr=Tr,kr=Nt,Ir=A([].concat),Er=Sr("Reflect","ownKeys")||function(e){var t=Or.f(kr(e)),n=Cr.f;return n?Ir(t,n(e)):t},Pr=qe,xr=Er,jr=h,Lr=xt,Rr=function(e,t,n){for(var r=xr(t),i=Lr.f,o=jr.f,a=0;a<r.length;a++){var s=r[a];Pr(e,s)||n&&Pr(n,s)||i(e,s,o(t,s))}},Ar=y,Nr=Q,Ur=/#|\.prototype\./,Dr=function(e,t){var n=Fr[Br(e)];return n==Mr||n!=zr&&(Nr(t)?Ar(t):!!t)},Br=Dr.normalize=function(e){return String(e).replace(Ur,".").toLowerCase()},Fr=Dr.data={},zr=Dr.NATIVE="N",Mr=Dr.POLYFILL="P",qr=Dr,Gr=m,Jr=h.f,Kr=Ht,Hr=function(e,t,n,r){r||(r={});var i=r.enumerable,o=void 0!==r.name?r.name:t;if(Hn(n)&&Yn(n,o,r),r.global)i?e[t]=n:Qn(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=n:Wn.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Wr=Re,Yr=Rr,Qr=qr,Vr=function(e,t){var n,r,i,o,a,s=e.target,c=e.global,u=e.stat;if(n=c?Gr:u?Gr[s]||Wr(s,{}):(Gr[s]||{}).prototype)for(r in t){if(o=t[r],i=e.dontCallGetSet?(a=Jr(n,r))&&a.value:n[r],!Qr(c?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Yr(o,i)}(e.sham||i&&i.sham)&&Kr(o,"sham",!0),Hr(n,r,o,e)}},Xr=v,Zr=Function.prototype,ei=Zr.apply,ti=Zr.call,ni="object"==typeof Reflect&&Reflect.apply||(Xr?ti.bind(ei):function(){return ti.apply(ei,arguments)}),ri=Q,ii=String,oi=TypeError,ai=A,si=Nt,ci=function(e){if("object"==typeof e||ri(e))return e;throw oi("Can't set "+ii(e)+" as a prototype")},ui=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=ai(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return si(n),ci(r),t?e(n,r):n.__proto__=r,n}}():void 0),fi=xt.f,li=Q,di=X,pi=ui,gi={};gi[ot("toStringTag")]="z";var mi="[object z]"===String(gi),hi=Q,yi=B,_i=ot("toStringTag"),vi=Object,wi="Arguments"==yi(function(){return arguments}()),bi=mi?yi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=vi(e),_i))?n:wi?yi(t):"Object"==(r=yi(t))&&hi(t.callee)?"Arguments":r},$i=bi,Ti=String,Si=function(e){if("Symbol"===$i(e))throw TypeError("Cannot convert a Symbol value to a string");return Ti(e)},Oi=Si,Ci=function(e,t){return void 0===e?arguments.length<2?"":t:Oi(e)},ki=X,Ii=Ht,Ei=function(e,t){ki(t)&&"cause"in t&&Ii(e,"cause",t.cause)},Pi=Error,xi=A("".replace),ji=String(Pi("zxcasd").stack),Li=/\n\s*at [^:]*:[^\n]*/,Ri=Li.test(ji),Ai=function(e,t){if(Ri&&"string"==typeof e&&!Pi.prepareStackTrace)for(;t--;)e=xi(e,Li,"");return e},Ni=E,Ui=!y((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ni(1,7)),7!==e.stack)})),Di=ne,Bi=qe,Fi=Ht,zi=re,Mi=ui,qi=Rr,Gi=function(e,t,n){n in e||fi(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},Ji=function(e,t,n){var r,i;return pi&&li(r=t.constructor)&&r!==n&&di(i=r.prototype)&&i!==n.prototype&&pi(e,i),e},Ki=Ci,Hi=Ei,Wi=Ai,Yi=Ui,Qi=_,Vi=Vr,Xi=ni,Zi=function(e,t,n,r){var i="stackTraceLimit",o=r?2:1,a=e.split("."),s=a[a.length-1],c=Di.apply(null,a);if(c){var u=c.prototype;if(Bi(u,"cause")&&delete u.cause,!n)return c;var f=Di("Error"),l=t((function(e,t){var n=Ki(r?t:e,void 0),i=r?new c(e):new c;return void 0!==n&&Fi(i,"message",n),Yi&&Fi(i,"stack",Wi(i.stack,2)),this&&zi(u,this)&&Ji(i,this,l),arguments.length>o&&Hi(i,arguments[o]),i}));l.prototype=u,"Error"!==s?Mi?Mi(l,f):qi(l,f,{name:!0}):Qi&&i in c&&(Gi(l,c,i),Gi(l,c,"prepareStackTrace")),qi(l,c);try{u.name!==s&&Fi(u,"name",s),u.constructor=l}catch(e){}return l}},eo=m.WebAssembly,to=7!==Error("e",{cause:7}).cause,no=function(e,t){var n={};n[e]=Zi(e,t,to),Vi({global:!0,constructor:!0,arity:1,forced:to},n)},ro=function(e,t){if(eo&&eo[e]){var n={};n[e]=Zi("WebAssembly."+e,t,to),Vi({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:to},n)}};function io(t){try{const n=e.unzipSync(Buffer.from(t,"base64")).toString();try{return decodeURIComponent(oo(n))}catch(e){return unescape(n)}}catch(e){throw new Error("Error: ÂΩìÂâçÂ≠óÁ¨¶‰∏≤‰∏çËÉΩË¢´GzipËß£Âéã")}}function oo(e){return e.replace(/\\u([\d\w]{4})/gi,((e,t)=>String.fromCodePoint(parseInt(t,16))))}no("Error",(function(e){return function(t){return Xi(e,this,arguments)}})),no("EvalError",(function(e){return function(t){return Xi(e,this,arguments)}})),no("RangeError",(function(e){return function(t){return Xi(e,this,arguments)}})),no("ReferenceError",(function(e){return function(t){return Xi(e,this,arguments)}})),no("SyntaxError",(function(e){return function(t){return Xi(e,this,arguments)}})),no("TypeError",(function(e){return function(t){return Xi(e,this,arguments)}})),no("URIError",(function(e){return function(t){return Xi(e,this,arguments)}})),ro("CompileError",(function(e){return function(t){return Xi(e,this,arguments)}})),ro("LinkError",(function(e){return function(t){return Xi(e,this,arguments)}})),ro("RuntimeError",(function(e){return function(t){return Xi(e,this,arguments)}}));var ao=xt.f,so=qe,co=ot("toStringTag"),uo=m,fo=function(e,t,n){e&&!n&&(e=e.prototype),e&&!so(e,co)&&ao(e,co,{configurable:!0,value:t})};Vr({global:!0},{Reflect:{}}),fo(uo.Reflect,"Reflect",!0);const lo=()=>process.env.QL_BRANCH;function po(){return global.IS_CFC||!1}function go(){return global.IS_CFC||!1}function mo(){const e=lo()?"cat_bili_config":"config",t=".json",{BILITOOLS_FILE_NAME:n}=process.env;return n?n.endsWith(t)?n:`${n}.json`:e+t}function ho(){const e=Object.keys(process.env),t=["securityToken","accessKeyID","accessKeySecret","FC_FUNCTION_MEMORY_SIZE","FC_FUNC_CODE_PATH","FC_RUNTIME_VERSION"];return e.filter((e=>t.includes(e))).length>=3||!0}function yo(){const e=Object.keys(process.env),t=e.filter((e=>e.startsWith("SCF_"))).length>=10,n=e.filter((e=>e.startsWith("TENCENTCLOUD_"))).length>=3;return t&&n||!1}function _o(){return yo()||ho()||go()||po()}const vo=["Ê£í","Ê£íÂîâ","Ê£íËÄ∂","Âä†Ê≤π~","UPÂä†Ê≤π!","ÊîØÊåÅ~","ÊîØÊåÅÊîØÊåÅÔºÅ","ÂÇ¨Êõ¥Âï¶","È°∂È°∂","Áïô‰∏ãËÑöÂç∞~","Âπ≤ÊùØ","bilibiliÂπ≤ÊùØ","o(*Ôø£‚ñΩÔø£*)o","(ÔΩ°ÔΩ•‚àÄÔΩ•)ÔæâÔæûÂó®","(‚óèÀá‚àÄÀá‚óè)","( ‚Ä¢ÃÄ œâ ‚Ä¢ÃÅ )y","(‡∏á ‚Ä¢_‚Ä¢)‡∏á",">.<","^_~"],wo=Object.prototype.toString;function bo(e,t){return wo.call(e)===`[object ${t}]`}function $o(e){return void 0!==e}function To(e){return!$o(e)}function So(e){return null!==e&&bo(e,"Object")}function Oo(e){return null===e}function Co(e){return bo(e,"Number")}function ko(e){return bo(e,"String")}function Io(e){return"function"==typeof e}function Eo(e){return e&&Array.isArray(e)}const Po="undefined"==typeof window,xo=!Po;function jo(e){const t=e||Ro(),n=t.getFullYear(),r=t.getMonth()+1;return 2===r?n%4==0&&n%100!=0||n%400==0?29:28:[4,6,9,11].includes(r)?30:31}function Lo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=c.randomBytes(1)[0]%16;return("x"===e?t:3&t|8).toString(16)}))}function Ro(){const e=new Date,t=e.getTime(),n=e.getTimezoneOffset()/60;return new Date(t+36e5*(n+8))}function Ao(e){const t=e||Ro(),n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate();return`${n}-${r<10?"0"+r:r}-${i<10?"0"+i:i}`}function No(e){const t=e.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}function Uo(e,t){return Math.ceil(t/e)}function Do(e,t,n){if(n&&"boolean"!=typeof n&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):void 0===t&&(t=e,e=0),e>t){const n=e;e=t,t=n}if(n||e%1||t%1){const n=Math.random();return Math.min(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)}return e+Math.floor(Math.random()*(t-e+1))}function Bo(e="17:30:00-23:40:00",t){const n=e.split("-"),r=n[0].split(":").map((e=>+e)),i=n[1].split(":").map((e=>+e)),o=Do(r[0]??19,i[0]??23);let a=0;a=o==r[0]?Do(r[1],59):o==i[0]?Do(i[1]):Do(59);let s=0;return s=o==r[0]?Do(r[2],59):o==i[0]?Do(i[2]):Do(59),Fo({seconds:s,hours:o,minutes:a},t)}function Fo({hours:e,minutes:t,seconds:n},r){let i;switch(n=n||0,r){case"scf":default:i=`${n} ${t} ${e} * * * *`;break;case"fc":i=`${n} ${t} ${e} * * *`;break;case"cfc":i=`corn(${t} ${e} * * *)`}return{value:i,string:`${e}:${t}:${n}`}}function zo(e,t){let n="";for(let t=0;t<e;t++)n+=Wo("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?n.toLowerCase():n}function Mo(){return`${Do(1,9)}${zo(10,!0)}0`}function qo(e,t){e.includes(t)||e.push(t)}function Go(e){return e||{}}function Jo(e,t=!1){return So(e)?Array.isArray(e)?e.map((e=>Jo(e,t))):t?Object.keys(e).reduce(((n,r)=>(n[r]=Jo(e[r],t),n)),{}):Object.assign({},e):e}function Ko(e,t){return void 0===e||void 0===t?e||t:So(e)&&So(t)?Array.isArray(e)&&Array.isArray(t)?e.concat(t):Object.keys(t).reduce(((n,r)=>(n[r]=Ko(e[r],t[r]),n)),e):t}function Ho(e){if(!So(e)&&!Eo(e))return e;const t=new URLSearchParams;return Array.isArray(e)||(e=Object.entries(e)),e.forEach((([e,n])=>{So(n)?t.append(e,JSON.stringify(n)):t.append(e,String(n))})),t.toString()}function Wo(e){return e[Do(e.length-1)]}function Yo(e,t=!1){const n=c.createHash("md5");return n.update(e),t?n.digest("hex").toUpperCase():n.digest("hex")}function Qo(e={},t={}){function n(e){return Object.keys(e).reduce(((t,n)=>(t[n.toLowerCase()]=e[n],t)),{})}return Object.assign({},n(e),n(t))}function Vo(e){return e&&e.map((e=>Number(e))).filter((e=>e>0&&e%1==0))}function Xo(){return Math.floor((new Date).getTime()/1e3)}function Zo(e,t=!0){return t?e.toLocaleString("zh-CN",{hour12:!1}):e.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function ea(e="info"){const t=["error","warn","info","verbose","debug"],n=t.indexOf(e);return-1!==n?t.slice(0,n+1):t}function ta(e){return u.resolve(process.cwd(),e)}class na{static pushValue="";static brChar="\n";month=Ro().getMonth()+1;errorFile=ta(`./logs/bt_error-${this.month}.log`);logFile=ta(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(e={console:"info",file:"info",push:"info"},t="default"){this.options=e,this.name=t,this.consoleLeval=ea(this.options.console),this.fileLeval=ea(this.options.file),this.pushLeval=ea(this.options.push),this.noFile=lo()||_o(),this.noFile||this.createLogFile()}log({level:e},t,n){n=n||ia[e];const r=Ro(),i=["error","warn"].includes(e),o=this.options.payload?` [${this.options.payload}] `:" ";this.consoleLeval.includes(e)&&this.Conslole(`[${n} ${Zo(r,!1)}]${o}${t}\n`,i),!this.noFile&&this.fileLeval.includes(e)&&this.File(`[${n} ${Zo(r,!0)}]${o}${t}\n`,i),this.pushLeval.includes(e)&&this.Push(`[${n} ${Zo(r,!1)}] ${t}${na.brChar}`)}error(e){this.log({level:"error"},e)}warn(e){this.log({level:"warn"},e)}info(e,t){this.log({level:"info"},e,t)}verbose(e){this.log({level:"verbose"},e)}debug(e){this.log({level:"debug"},e)}Conslole(e,t){t?process.stderr.write(e):process.stdout.write(e)}File(e,t){t&&f.appendFileSync(this.errorFile,e,"utf-8"),f.appendFileSync(this.logFile,e,"utf-8")}Push(e){na.pushValue+=e}createLogFile(){const e=ta("./logs");f.existsSync(e)||f.mkdirSync(e)}static async init(){na.pushValue="";try{const{TaskConfig:e}=await Promise.resolve().then((function(){return Os}));na.brChar=e.message.br||"\n"}catch{}}}const ra=new na({console:"debug",file:"debug",push:"debug"}),ia={error:"‚ùì",warn:"‚ùî",info:"üëª",verbose:"üí¨",debug:"üêõ"};class oa{static configFileName=mo();static isQingLongPanel=lo()}const aa=l.default?l.default:l;function sa(e){try{let t;if((r.existsSync(e)||r.existsSync(e+="5"))&&(t=r.readFileSync(e,"utf-8")),!t)return;return aa.parse(t)}catch(e){ra.error(e),function(e){if(!ko(e))return;if(e.includes("SyntaxError: JSON5"))throw new SyntaxError("ÈÖçÁΩÆÊñá‰ª∂Â≠òÂú®Ôºå‰ΩÜÊòØÊó†Ê≥ïËß£ÊûêÔºÅÂèØËÉΩ JSON5 Ê†ºÂºè‰∏çÊ≠£Á°ÆÔºÅ");throw new Error(e)}(e.message)}}const ca=e=>u.resolve(process.cwd(),e),ua=e=>u.resolve(__dirname,"../",e),fa=Array.from(new Set([ca("./config/config.dev.json"),ca(`./config/${oa.configFileName}`),ca(`./${oa.configFileName}`),ua(`./config/${oa.configFileName}`),ua(`./${oa.configFileName}`)])),la=["./config.json",ca("./config/config.json")];function da(e){let t;const n=Array.isArray(e);if(t=n?e:e.account.filter((e=>e.cookie)),0===t.length)return;if(oa.isQingLongPanel)return function(e){const t=process.argv.find((e=>e.includes("--item")||e.includes("-i")||e.includes("-I")));if(!t)return e[0];const n=Number(t.split("=")[1])-1;return!n||n>=e.length||n<0?(ra.warn("‰ºº‰πéÊÉ≥Ë¶ÅÊåáÂÆö‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÁî®Êà∑ÔºåÊàë‰ª¨Â∞ÜÊåáÂÆöÁ¨¨‰∏Ä‰∏™Áî®Êà∑"),e[0]):e[n]}(t);ra.warn("Âú®ÂçïÁî®Êà∑Âú∫ÊôØ‰∏ãÈÖçÁΩÆ‰∫ÜÂ§öÁî®Êà∑ÔºåÊàë‰ª¨Â∞ÜÊîæÂºÉÂ§ö‰ΩôÁöÑÈÖçÁΩÆ");const r=t[0];return n||(r.message=Object.assign(e.message||{},r.message)),r}function pa(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;oa.isQingLongPanel&&fa.splice(0,1,...la);for(let e=0;e<fa.length;e++){const t=sa(fa[e]);if(t)return ra.verbose(`ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ ${fa[e]}`),t}return(()=>{const{BILITOOLS_CONFIG:e,BILI_SCF_CONFIG:t,BILI_CONFIG:n}=process.env,r=e||t||n;if(r)try{return aa.parse(io(r))}catch(e){throw ra.error(e),new Error("ÁéØÂ¢É‰∏≠ÁöÑÈÖçÁΩÆ‰∏çÊòØÊúâÊïàÁöÑ JSON Â≠óÁ¨¶‰∏≤ÔºÅ")}})()}function ga(e){return function(e,t=!1){if(!e)throw new Error("Ëé∑ÂèñÈÖçÁΩÆÂ§±Ë¥•ÔºÅÊú™ÊâæÂà∞ÈÖçÁΩÆÊñá‰ª∂ÔºÅ");if(t)return function(e){const t=e=>e.cookie&&e.cookie.length>90&&["bili_jct","SESSDATA","DedeUserID"].every((t=>e.cookie.includes(t)));if(Array.isArray(e))return e.filter(t);return e.account.filter(t)}(ma(e)?e:[e]);if(ma(e)){const t=da(e);if(t)return t}if(!e.cookie)throw new Error("ÈÖçÁΩÆÊñá‰ª∂‰∏≠Ê≤°Êúâ cookieÔºÅ");return e}(pa(),e)}function ma(e){return!!Array.isArray(e)||Boolean(e.account&&e.account.length)}var ha=X,ya=B,_a=ot("match"),va=Nt,wa=$,ba=qe,$a=re,Ta=function(){var e=va(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Sa=RegExp.prototype,Oa=A,Ca=Fe,ka=Math.floor,Ia=Oa("".charAt),Ea=Oa("".replace),Pa=Oa("".slice),xa=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ja=/\$([$&'`]|\d{1,2})/g,La=Vr,Ra=$,Aa=A,Na=K,Ua=Q,Da=function(e){var t;return ha(e)&&(void 0!==(t=e[_a])?!!t:"RegExp"==ya(e))},Ba=Si,Fa=Ce,za=function(e){var t=e.flags;return void 0!==t||"flags"in Sa||ba(e,"flags")||!$a(Sa,e)?t:wa(Ta,e)},Ma=function(e,t,n,r,i,o){var a=n+e.length,s=r.length,c=ja;return void 0!==i&&(i=Ca(i),c=xa),Ea(o,c,(function(o,c){var u;switch(Ia(c,0)){case"$":return"$";case"&":return e;case"`":return Pa(t,0,n);case"'":return Pa(t,a);case"<":u=i[Pa(c,1,-1)];break;default:var f=+c;if(0===f)return o;if(f>s){var l=ka(f/10);return 0===l?o:l<=s?void 0===r[l-1]?Ia(c,1):r[l-1]+Ia(c,1):o}u=r[f-1]}return void 0===u?"":u}))},qa=ot("replace"),Ga=TypeError,Ja=Aa("".indexOf);Aa("".replace);var Ka=Aa("".slice),Ha=Math.max,Wa=function(e,t,n){return n>e.length?-1:""===t?n:Ja(e,t,n)};function Ya(e){return e?e.split("; ").map((e=>e.split("="))):[]}function Qa(e,t){const n=Ya(null==t?void 0:t[0]).filter((e=>2===e.length)),r=Ya(e).concat(n).filter((e=>2===e.length)),i={};for(const e of r)i[e[0]]?i[e[0]]=e[1]:Object.defineProperty(i,e[0],{value:e[1],enumerable:!0,writable:!0});return Object.keys(i).forEach((e=>{var t;i[e]=(t=i[e],encodeURIComponent(t).replaceAll("%7C","|").replaceAll("%2B","+").replaceAll("%25","%").replaceAll("*","%2A"))})),i}function Va(e){return Xa(Qa(e))}function Xa(e){const t=Object.keys(e).reduce(((t,n)=>t+`${n}=${e[n]}; `),"");return t.substring(0,t.length-2||0)}function Za(e,t){if(!e)return null;const n=`(?:^|)${t}=([^;]*)(?:;|$)`,r=e.match(n);return r?r[1]:null}function es(e){return Number(Za(e,"DedeUserID"))||0}function ts(e){return Za(e,"bili_jct")||""}La({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,a,s,c,u,f=Na(this),l=0,d=0,p="";if(null!=e){if(Da(e)&&(n=Ba(Na(za(e))),!~Ja(n,"g")))throw Ga("`.replaceAll` does not allow non-global regexes");if(r=Fa(e,qa))return Ra(r,e,f,t)}for(i=Ba(f),o=Ba(e),(a=Ua(t))||(t=Ba(t)),s=o.length,c=Ha(1,s),l=Wa(i,o,0);-1!==l;)u=a?Ba(t(o,l,i)):Ma(o,i,l,[],void 0,t),p+=Ka(i,d,l)+u,d=l+s,l=Wa(i,o,l+c);return d<i.length&&(p+=Ka(i,d)),p}});const ns={cookie:"",accessKey:"",message:{br:"\n",email:{host:"smtp.163.com",port:465},pushplusToken:process.env.PUSHPLUS_TOKEN,api:{method:"POST",headers:{"Content-Type":"application/json"},timeout:5e3,url:"",proxy:{host:"",port:443,auth:""},data:{}}},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,liveIntimacy:!1,mangaTask:!1,bigPoint:!1,liveFamine:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:[10,20]},gift:{mids:[]},coin:{customizeUp:[],retryNum:4,targetLevel:6,stayCoins:0,targetCoins:5},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["Ëà∞","Ëàπ","Ëà™Êµ∑","‰ª£ÈáëÂà∏","‰ºòÊÉ†Âà∏","Ëá™Êãç","ÁÖß","ÂÜôÁúü","Âõæ","ÊèêÁù£","ËΩ¶ËΩ¶‰∏ÄÂ±Ä","ÂÜçÊù•‰∏ÄÂ±Ä","Ê∏∏ÊàèÈÅìÂÖ∑"],includeAward:["Ë∞¢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"Â§©ÈÄâÊó∂Âàª",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,liveHeart:!1,whiteList:[],blackList:[]},manga:{sign:!0,buy:!1,mc:[],name:[],love:!0,buyInterval:6,buyWeek:[3]},activity:{liveFamineTime:400},BILIJCT:"",USERID:0};function rs(e){return function(e){!function(e){e.BILIJCT=ts(e.cookie),e.USERID=es(e.cookie)}(e);const{coin:t,gift:n,charge:r,match:i}=e;Eo(e.apiDelay)?e.apiDelay=Vo(e.apiDelay):e.apiDelay=[Number(e.apiDelay)];t.customizeUp=Vo(t.customizeUp),n.mids=Vo(n.mids),0===n.mids.length&&(n.mids=t.customizeUp);r.mid||(r.mid=e.USERID);t.targetCoins>5&&(t.targetCoins=5);i.coins>10&&(i.coins=10);return e}(function(e){return Object.keys(is).forEach((t=>{if(void 0!==e[t]){const[n,r]=is[t];e[n]=Go(e[n]),e[n][r]=e[t]}delete e[t]})),e}(Ko(Jo(ns,!0),function(e){const{message:t}=e;if(t&&ko(t.api)){const e=t.api;t.api=Jo(ns.message.api,!0),t.api.url=e,t.api.method="GET"}return e}(e))))}const is={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};const os="https://account.bilibili.com",as="https://live.bilibili.com",ss="https://space.bilibili.com",cs="https://message.bilibili.com",us="https://www.bilibili.com",fs="https://www.bilibili.com/",ls="https://big.bilibili.com/mobile/bigPoint",ds="https://big.bilibili.com/mobile/bigPoint/task",ps="https://account.bilibili.com",gs="https://api.live.bilibili.com",ms="https://api.bilibili.com",hs="https://manga.bilibili.com",ys="https://api.vc.bilibili.com",_s="https://live-trace.bilibili.com",vs={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"};function ws({version:e="6.78.0",phone:t="MI 10 Pro",build:n="6780300",channel:r="xiaomi",os:i="10"}={}){return`Mozilla/5.0 BiliDroid/${e} (bbcallen@gmail.com) os/android model/${t} mobi_app/android build/${n} channel/${r} innerVer/${r} osVer/${i} network/2`}let bs;const $s=new Proxy({},{get:(e,t)=>(bs||Ss(),Reflect.get(bs,t)),set:(e,t,n)=>"config"===t&&n?(Ss(n),!0):Reflect.set(bs,t,n)});let Ts=null;function Ss(e){e||(e=ga(!1));const t=rs(e);bs={...t,mobileUA:ws(),cookie:Va(t.cookie)},Ts=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static vipStatus=0;static userLevel=0}{},Ts.coinsTask=bs.coin.targetCoins}var Os=Object.freeze({__proto__:null,TaskConfig:$s,get TaskModule(){return Ts},initialize:Ss,changeConfig:function(e){const t=ga();t[e]&&Ss(t[e])}});function Cs(e,t){const n=Is(e,t);return new Promise((e=>{setTimeout((()=>{e(n)}),n)}))}function ks(e,t){Is(e,t)}function Is(e,t){if(e&&t)return Do(e,t);if(e)return e;const n=$s.apiDelay;return 1===n.length?1e3*n[0]:1e3*Do(n[0]||2,n[1]||6)}var Es=Object.freeze({__proto__:null,gzipEncode:function(t){try{return e.gzipSync(encodeURIComponent(t)).toString("base64")}catch(e){return"Error: ÂΩìÂâçÂ≠óÁ¨¶‰∏≤‰∏çËÉΩË¢´GzipÂéãÁº©"}},gzipDecode:io,unicode2str:oo,apiDelay:Cs,apiDelaySync:ks,encodeCookie:Va,getCookieItem:Za,getUserId:es,getBiliJct:ts,getLIVE_BUVID:function(e){return Za(e,"LIVE_BUVID")||""},isQingLongPanel:lo,isCFC:po,isAGC:go,setConfigFileName:mo,isFC:ho,isSCF:yo,isServerless:_o,Logger:na,logger:ra,getMonthHasDays:jo,createUUID:Lo,getPRCDate:Ro,getDateString:Ao,jsonp2Object:No,getPageNum:Uo,setCron:function(e=6e4,t){e=e||6e4;const n=Ro().getTime()+e,r=new Date(n),i=r.getSeconds(),o=r.getMinutes();return Fo({hours:r.getHours(),minutes:o,seconds:i},t)},random:Do,randomDailyRunTime:Bo,formatCron:Fo,randomString:zo,getVisitId:Mo,pushIfNotExist:qo,getNewObject:Go,cloneObject:Jo,deepMergeObject:Ko,stringify:Ho,getRandomItem:Wo,md5:Yo,mergeHeaders:Qo,arr2numArr:Vo,base64Encode:function(e){return Buffer.from(e).toString("base64")},isTodayInTimeArr:function(e){if(!e||!e.length)return!0;const t=(new Date).getDate();return e.includes(t)},getUnixTime:Xo,is:bo,isDef:$o,isUnDef:To,isObject:So,isEmpty:function(e){return Eo(e)||ko(e)?0===e.length:e instanceof Map||e instanceof Set?0===e.size:!!So(e)&&0===Object.keys(e).length},isDate:function(e){return bo(e,"Date")},isNull:Oo,isNullAndUnDef:function(e){return To(e)&&Oo(e)},isNullOrUnDef:function(e){return To(e)||Oo(e)},isNumber:Co,isPromise:function(e){return bo(e,"Promise")&&So(e)&&Io(e.then)&&Io(e.catch)},isString:ko,isFunction:Io,isBoolean:function(e){return bo(e,"Boolean")},isRegExp:function(e){return bo(e,"RegExp")},isArray:Eo,isWindow:function(e){return"undefined"!=typeof window&&bo(e,"Window")},isElement:function(e){return So(e)&&!!e.tagName},isMap:function(e){return bo(e,"Map")},isServer:Po,isClient:xo,isUrl:function(e){return/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(?::\d+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/.test(e)},isEmail:function(e){return/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(e)}}),Ps=!y((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),xs=qe,js=Q,Ls=Fe,Rs=Ps,As=hn("IE_PROTO"),Ns=Object,Us=Ns.prototype,Ds=Rs?Ns.getPrototypeOf:function(e){var t=Ls(e);if(xs(t,As))return t[As];var n=t.constructor;return js(n)&&t instanceof n?n.prototype:t instanceof Ns?Us:null},Bs={},Fs=vr,zs=wr,Ms=Object.keys||function(e){return Fs(e,zs)},qs=_,Gs=jt,Js=xt,Ks=Nt,Hs=Y,Ws=Ms;Bs.f=qs&&!Gs?Object.defineProperties:function(e,t){Ks(e);for(var n,r=Hs(t),i=Ws(t),o=i.length,a=0;o>a;)Js.f(e,n=i[a++],r[n]);return e};var Ys,Qs=ne("document","documentElement"),Vs=Nt,Xs=Bs,Zs=wr,ec=yn,tc=Qs,nc=vt,rc=hn("IE_PROTO"),ic=function(){},oc=function(e){return"<script>"+e+"<\/script>"},ac=function(e){e.write(oc("")),e.close();var t=e.parentWindow.Object;return e=null,t},sc=function(){try{Ys=new ActiveXObject("htmlfile")}catch(e){}var e,t;sc="undefined"!=typeof document?document.domain&&Ys?ac(Ys):((t=nc("iframe")).style.display="none",tc.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(oc("document.F=Object")),e.close(),e.F):ac(Ys);for(var n=Zs.length;n--;)delete sc.prototype[Zs[n]];return sc()};ec[rc]=!0;var cc=Object.create||function(e,t){var n;return null!==e?(ic.prototype=Vs(e),n=new ic,ic.prototype=null,n[rc]=e):n=sc(),void 0===t?n:Xs.f(n,t)},uc=Se,fc=v,lc=A(A.bind),dc={},pc=dc,gc=ot("iterator"),mc=Array.prototype,hc=bi,yc=Ce,_c=dc,vc=ot("iterator"),wc=function(e){if(null!=e)return yc(e,vc)||yc(e,"@@iterator")||_c[hc(e)]},bc=$,$c=Se,Tc=Nt,Sc=we,Oc=wc,Cc=TypeError,kc=$,Ic=Nt,Ec=Ce,Pc=function(e,t){return uc(e),void 0===t?e:fc?lc(e,t):function(){return e.apply(t,arguments)}},xc=$,jc=Nt,Lc=we,Rc=function(e){return void 0!==e&&(pc.Array===e||mc[gc]===e)},Ac=cr,Nc=re,Uc=function(e,t){var n=arguments.length<2?Oc(e):t;if($c(n))return Tc(bc(n,e));throw Cc(Sc(e)+" is not iterable")},Dc=wc,Bc=function(e,t,n){var r,i;Ic(e);try{if(!(r=Ec(e,"return"))){if("throw"===t)throw n;return n}r=kc(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return Ic(r),n},Fc=TypeError,zc=function(e,t){this.stopped=e,this.result=t},Mc=zc.prototype,qc=function(e,t,n){var r,i,o,a,s,c,u,f=n&&n.that,l=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),g=Pc(t,f),m=function(e){return r&&Bc(r,"normal",e),new zc(!0,e)},h=function(e){return l?(jc(e),p?g(e[0],e[1],m):g(e[0],e[1])):p?g(e,m):g(e)};if(d)r=e;else{if(!(i=Dc(e)))throw Fc(Lc(e)+" is not iterable");if(Rc(i)){for(o=0,a=Ac(e);a>o;o++)if((s=h(e[o]))&&Nc(Mc,s))return s;return new zc(!1)}r=Uc(e,i)}for(c=r.next;!(u=xc(c,r)).done;){try{s=h(u.value)}catch(e){Bc(r,"throw",e)}if("object"==typeof s&&s&&Nc(Mc,s))return s}return new zc(!1)},Gc=Vr,Jc=re,Kc=Ds,Hc=ui,Wc=Rr,Yc=cc,Qc=Ht,Vc=E,Xc=Ai,Zc=Ei,eu=qc,tu=Ci,nu=Ui,ru=ot("toStringTag"),iu=Error,ou=[].push,au=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=Jc(su,this);Hc?n=Hc(new iu,i?Kc(this):su):(n=i?this:Yc(su),Qc(n,ru,"Error")),void 0!==t&&Qc(n,"message",tu(t)),nu&&Qc(n,"stack",Xc(n.stack,1)),Zc(n,r);var o=[];return eu(e,ou,{that:o}),Qc(n,"errors",o),n};Hc?Hc(au,iu):Wc(au,iu,{name:!0});var su=au.prototype=Yc(iu.prototype,{constructor:Vc(1,au),message:Vc(1,""),name:Vc(1,"AggregateError")});Gc({global:!0,constructor:!0,arity:2},{AggregateError:au});var cu={},uu=Se,fu=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=uu(t),this.reject=uu(n)};cu.f=function(e){return new fu(e)};var lu=$,du=Se,pu=ne,gu=cu,mu=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},hu=qc;Vr({target:"Promise",stat:!0},{any:function(e){var t=this,n=pu("AggregateError"),r=gu.f(t),i=r.resolve,o=r.reject,a=mu((function(){var r=du(t.resolve),a=[],s=0,c=1,u=!1;hu(e,(function(e){var f=s++,l=!1;c++,lu(r,t,e).then((function(e){l||u||(u=!0,i(e))}),(function(e){l||u||(l=!0,a[f]=e,--c||o(new n(a,"No one promise resolved")))}))})),--c||o(new n(a,"No one promise resolved"))}));return a.error&&o(a.value),r.promise}});const yu=(e,t)=>{const{isTransformResponse:n,isReturnNativeResponse:r}=t;if(r)return e;if(!1===n)return e.body;const{body:i}=e;if(t.isJsonp&&ko(i))return No(i);try{if(ko(i)&&i.startsWith("{"))return JSON.parse(i)}catch{}return i};class _u{name="VGot";constructor(e){e.baseURL&&(e.prefixUrl=e.baseURL),this.options=e,this.gotInstance=d.default.extend(e,{hooks:{afterResponse:[e=>{const{requestOptions:t}=e.request.options;var n,r,i;null!=t&&t.withBiliCookie&&($s.cookie=(r=$s.cookie,i=(null===(n=e.headers)||void 0===n?void 0:n["set-cookie"])||[],r?i&&0!==i.length?Xa(Qa(r,i)):r:""));return e}]}})}request(e){const{requestOptions:t={},headers:n={}}=this.options;return e.requestOptions=Object.assign({},t,e.requestOptions),e.headers=Qo(n,e.headers),t.withBiliCookie&&(e.headers.Cookie=$s.cookie),t.retry&&(e.retry=t.retry),e=function(e){ko(e.url)||(e.url=e.url.toString()),So(e.params)&&!ko(e.searchParams)&&(e.searchParams={...e.searchParams,...e.params});const t=e.headers["content-type"],n=null==t?void 0:t.startsWith("application/x-www-form-urlencoded");function r(t){e.agent||(e.agent={}),e.agent[t]=e[`${t}Agent`]}return So(e.data)&&(n?e.body=Ho(e.data):e.json=e.data),ko(e.data)&&n&&(e.body=e.data),e.httpAgent&&r("http"),e.httpsAgent&&r("https"),e.url&&e.url.startsWith("/")&&(e.url=e.url.substring(1)),e}(e),new Promise(((t,n)=>{this.gotInstance(e).then((r=>{if(Io(yu))try{const n=yu(r,e.requestOptions);t(n)}catch(e){n(e||new Error("ËØ∑Ê±ÇÈîôËØØ!"))}else t(r)})).catch((e=>{e.response&&(e.response.status=e.response.statusCode),n(e)}))}))}get(e,t){return ko(e)?this.request({...t,method:"GET",url:e}):this.request({...e,method:"GET"})}post(e,t,n){return ko(e)?this.request({...n,method:"POST",url:e,data:t}):this.request({...e,method:"POST"})}put(e,t,n){return this.request({...n,method:"PUT",url:e,data:t})}delete(e,t,n){return this.request({...n,method:"DELETE",url:e,data:t})}patch(e,t,n){return this.request({...n,method:"PATCH",url:e,data:t})}}function vu(e){return new _u(Ko({timeout:1e4,headers:{"content-type":vs["content-type"],"user-agent":vs["user-agent"],"accept-language":vs["accept-language"],"accept-encoding":vs["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},e||{}))}const wu=vu({requestOptions:{withBiliCookie:!1}}),bu=vu();wu.name;async function $u(e,t){(async e=>{ra.info(e||"ÈòøÈáå‰∫ë FC ÊµãËØïing")})();const{dailyHandle:n}=await Promise.resolve().then((function(){return Tu}));return await n({event:e,context:t,slsType:"fc"})}(async()=>{ra.info("ÂºÄÂßãÊâßË°åÁΩëÁªú‰ª£Á†Å");$u(JSON.parse(event.toString()),context).then((e=>{VMThis.message=e,VMThis.resolve(VMThis.message)})).catch((e=>{VMThis.error=e,VMThis.reject(VMThis.error)}))})();var Tu=Object.freeze({__proto__:null,dailyHandle:async function({event:e,context:t,slsType:n}){const r=function(e,t){return"scf"===e?t.Message:t.payload}(n,e),i=await async function(e,t,n){const r="scf"===e?(await Promise.resolve().then((function(){return Qu}))).default:(await Promise.resolve().then((function(){return Vu}))).default;return(...e)=>r(t,n,...e)}(n,e,t);let o;try{o=JSON.parse(r)}catch(e){}return o&&o.lastTime===Ro().getDate().toString()?"‰ªäÊó•ÈáçÂ§çÊâßË°å":await async function(e,...t){const{getBiliTask:n}=await Promise.resolve().then((function(){return Cu})),{apiDelay:r,logger:i,Logger:o}=await Promise.resolve().then((function(){return Es})),{getWaitRuningFunc:a}=await Promise.resolve().then((function(){return ku})),{sendMessage:s}=await Promise.resolve().then((function(){return Ku})),{printVersion:c}=await Promise.resolve().then((function(){return Yu}));await o.init(),await c();try{const e=await n("loginTask");await e()}catch(e){return i.error(`ÁôªÂΩïÂ§±Ë¥•: ${e}`),await s("ÁôªÂΩïÂ§±Ë¥•",o.pushValue),"Êú™ÂÆåÊàê"}const u=a();for await(const e of u)try{await e()}catch(t){i.error(`${e.name}Â§±Ë¥•: ${t}`)}finally{await r()}return e&&await e(...t),await s("ÊØèÊó•ÂÆåÊàê",o.pushValue),"ÂÆåÊàê"}(i)}});const Su=["taskReward","liveSignTask","addCoins","bigPoint","shareAndWatch","silver2Coin","mangaSign","mangaTask","supGroupSign","liveSendMessage","charging","getVipPrivilege","matchGame","liveLottery","liveRedPack","liveIntimacy","giveGift","loginTask","liveFamine"],Ou=[()=>Promise.resolve().then((function(){return Sf})),()=>Promise.resolve().then((function(){return If})),()=>Promise.resolve().then((function(){return Pf})),()=>Promise.resolve().then((function(){return tl})),()=>Promise.resolve().then((function(){return nl})),()=>Promise.resolve().then((function(){return rl})),()=>Promise.resolve().then((function(){return gl})),()=>Promise.resolve().then((function(){return ml})),()=>Promise.resolve().then((function(){return _l})),()=>Promise.resolve().then((function(){return Rl})),()=>Promise.resolve().then((function(){return Nl})),()=>Promise.resolve().then((function(){return Fl})),()=>Promise.resolve().then((function(){return ql})),()=>Promise.resolve().then((function(){return hd})),()=>Promise.resolve().then((function(){return bd})),()=>Promise.resolve().then((function(){return $d})),()=>Promise.resolve().then((function(){return Cd})),()=>Promise.resolve().then((function(){return Pd})),()=>Promise.resolve().then((function(){return Nd}))];var Cu=Object.freeze({__proto__:null,taskExportOrder:Su,biliTasks:Ou,getBiliTask:async function(e){const t=Su.findIndex((t=>t===e));return-1===t?()=>Promise.resolve():(await Ou[t]()).default},default:Ou});var ku=Object.freeze({__proto__:null,getWaitRuningFunc:function(){const e=function(){const e=$s.function;return e.addCoins||e.shareAndWatch||(e.taskReward=!1),e.liveIntimacy&&$s.intimacy.liveSendMessage&&(e.liveSendMessage=!1),e.mangaTask&&$s.manga.sign&&(e.mangaSign=!1),e}(),t=[];return Su.forEach(((n,r)=>{e[n]&&t.push(Ou[r])})),t.map((async e=>(await e()).default))}});function Iu(e={},t,n){return function(e,t="1d8b6e7d45233436",n="560c52ccd288fed045859ed18bffd973"){if(e={...e,platform:"android",mobi_app:"android",disable_rcmd:0,build:6780300,c_locale:"zh_CN",s_locale:"zh_CN",ts:Xo()},!$s.accessKey)return Eu(e,n,!0);return delete e.csrf,delete e.csrf_token,Eu(e={...e,access_key:$s.accessKey,actionKey:"appkey",appkey:t},n)}(e,t,n).query}function Eu(e,t,n=!1){const r=Ho(function(e){return Object.keys(e).sort().map((t=>[t,e[t]]))}(e));if(n)return{query:r,sign:""};const i=Yo(r+t);return{query:r+"&sign="+i,sign:i}}function Pu(e){return Object.keys(e).forEach((t=>{Co(e[t])?e[t]=e[t].toString():So(e[t])?Pu(e[t]):Eo(e[t])&&(e[t]=e[t].map((e=>So(e)?Pu(e):e.toString())))})),e}function xu(e){let t=JSON.stringify(Pu(e));const n=["SHA512","SHA3-512","SHA384","SHA3-384","BLAKE2b512"];for(const e of n)t=c.createHash(e).update(t).digest("hex");return t}let ju={};function Lu(){var e;const t=$s.message||{};ju=function(e={}){return ju.SCKEY="",ju.BARK_PUSH="",ju.BARK_SOUND="",ju.BARK_GROUP="QingLong",ju.TG_BOT_TOKEN="",ju.TG_USER_ID="",ju.TG_PROXY_HOST="",ju.TG_PROXY_PORT="",ju.TG_PROXY_AUTH="",ju.TG_API_HOST="api.telegram.org",ju.DD_BOT_TOKEN="",ju.DD_BOT_SECRET="",ju.QYWX_KEY="",ju.QYWX_AM="",ju.IGOT_PUSH_KEY="",ju.PUSH_PLUS_TOKEN="",ju.PUSH_PLUS_USER="",ju.QQ_SKEY="",ju.QQ_MODE="",e}(ju),["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((e=>{const n=t[(r=e,r.toLowerCase().replace(/_(\w)/g,((e,t)=>t.toUpperCase())))]||t[e]||process.env[e];var r;n&&(ju[e]=n)})),null!==(e=$s.message)&&void 0!==e&&e.pushplusToken&&(ju.PUSH_PLUS_TOKEN=$s.message.pushplusToken)}async function Ru(e,t){var n;const r=null===(n=$s.message)||void 0===n?void 0:n.email;if(!(r&&r.pass&&r.from&&r.host))return;const{createTransport:i}=await Promise.resolve().then((function(){return s(require("nodemailer"))})),o=Number(r.port)||465,a=i({host:r.host,port:o,secure:465===o,auth:{user:r.from,pass:r.pass}}),c=await a.sendMail({from:`${e} <${r.from}>`,to:r.to,subject:e,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});ra.info(`ÈÇÆ‰ª∂Ê∂àÊÅØÂ∑≤ÂèëÈÄÅ: ${c.messageId}`)}async function Au(e,t){try{const n=$s.message.api;if(!n||!n.url)return;const{data:r,proxy:i,timeout:o,headers:a}=n,c={method:n.method.toUpperCase()||"POST",timeout:o,headers:a,url:""};if(c.url=n.url.replace("{title}",encodeURIComponent(e)).replace("{text}",encodeURIComponent(t)),i.host){const e=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:i.host,port:+i.port,proxyAuth:i.auth},maxSockets:1});Object.assign(c,{httpsAgent:e})}const u=Object.keys(r);u.length&&(u.forEach((n=>{"{text}"===r[n]&&(r[n]=t),"{title}"===r[n]&&(r[n]=e)})),Object.assign(c,{data:r})),await wu.request(c),ra.info("Ëá™ÂÆö‰πâÊé•Âè£Ê∂àÊÅØÂ∑≤ÂèëÈÄÅÔºÅ")}catch(e){ra.info(`Ëá™ÂÆö‰πâÊé•Âè£Ê∂àÊÅØÂèëÈÄÅÂ§±Ë¥•: ${e}`),ra.error(e)}}function Nu(e,t,n=2100){return new Promise((r=>{const i=ju.SCKEY;if(i){t=t.replace(/[\n\r]/g,"\n\n");const o={url:i.includes("SCT")?`https://sctapi.ftqq.com/${i}.send`:`https://sc.ftqq.com/${i}.send`,data:`text=${e}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{wu.post(o).then((e=>{0===e.errno||0===e.data.errno?ra.info("serverÈÖ±ÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ"):1024===e.errno?ra.info(`serverÈÖ±ÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂºÇÂ∏∏: ${e.errmsg}`):ra.info(`serverÈÖ±ÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂºÇÂ∏∏\n${JSON.stringify(e)}`)})).catch((e=>{ra.info("serverÈÖ±ÂèëÈÄÅÈÄöÁü•Ë∞ÉÁî®APIÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})).finally((()=>{r("")}))}),n)}else r("")}))}function Uu(e,t){return new Promise((n=>{const{QQ_SKEY:r,QQ_MODE:i}=ju;if(r){const o={url:`https://push.xuthus.cc/${i}/${r}`,headers:{"Content-Type":"application/json"},data:{},params:{}};e=e.replace(/‰∫¨Ë±Ü/g,"Ë±ÜË±Ü"),t=(t=(t=t.replace(/‰∫¨Ë±Ü/g,"")).replace(/üê∂/g,"")).replace(/Á∫¢ÂåÖ/g,"HÂåÖ"),o.data="email"===i?{t:e,c:t}:`${e}\n\n${t}`;const a=function(e){switch(e){case"send":return"‰∏™‰∫∫";case"group":return"QQÁæ§";case"wx":return"ÂæÆ‰ø°";case"ww":return"‰ºÅ‰∏öÂæÆ‰ø°";case"email":return"ÈÇÆ‰ª∂";default:return"Êú™Áü•ÊñπÂºè"}};wu.post(o).then((e=>{200===e.code?ra.info(`ÈÖ∑Êé®ÂèëÈÄÅ${a(i)}ÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ`):400===e.code?ra.info(`QQÈÖ∑Êé®(Cool Push)ÂèëÈÄÅ${a(i)}Êé®ÈÄÅÂ§±Ë¥•Ôºö${e.msg}`):503===e.code?ra.info(`QQÈÖ∑Êé®Âá∫ÈîôÔºå${e.message}Ôºö${e.data}`):ra.info(`ÈÖ∑Êé®Êé®ÈÄÅÂºÇÂ∏∏: ${JSON.stringify(e)}`)})).catch((e=>{ra.info(`ÂèëÈÄÅ${a(i)}ÈÄöÁü•Ë∞ÉÁî®APIÂ§±Ë¥•ÔºÅÔºÅ`),ra.info(e)})).finally((()=>{n("")}))}else n("")}))}function Du(e,t,n={}){return new Promise((r=>{const{BARK_PUSH:i,BARK_SOUND:o,BARK_GROUP:a}=ju;if(i){const s={url:`${i}/${encodeURIComponent(e)}/${encodeURIComponent(t)}?sound=${o}&group=${a}&${Ho(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};wu.get(s).then((e=>{200===e.code?ra.info("Bark APPÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ"):ra.info(`Bark APPÂèëÈÄÅÈÄöÂ§±Ë¥•Ôºö${e.message}`)})).catch((e=>{ra.info("Bark APPÂèëÈÄÅÈÄöÁü•Ë∞ÉÁî®APIÂ§±Ë¥•ÔºÅÔºÅ"),ra.error(e)})).finally((()=>{r("")}))}r("")}))}function Bu(e,t){return new Promise((async n=>{const{TG_BOT_TOKEN:r,TG_USER_ID:i,TG_API_HOST:o,TG_PROXY_HOST:a,TG_PROXY_PORT:c,TG_PROXY_AUTH:u}=ju;if(r&&i){const f={url:`https://${o}/bot${r}/sendMessage`,data:`chat_id=${i}&text=${e}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(a&&c){const e=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:a,port:+c,proxyAuth:u},maxSockets:1});Object.assign(f,{httpsAgent:e})}wu.post(f).then((e=>{e.ok?ra.info("TelegramÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ„ÄÇ"):400===e.error_code?ra.info("ËØ∑‰∏ªÂä®ÁªôbotÂèëÈÄÅ‰∏ÄÊù°Ê∂àÊÅØÂπ∂Ê£ÄÊü•Êé•Êî∂Áî®Êà∑IDÊòØÂê¶Ê≠£Á°Æ„ÄÇ"):401===e.error_code&&ra.info("Telegram bot token Â°´ÂÜôÈîôËØØ„ÄÇ")})).catch((e=>{ra.info("telegramÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})).finally((()=>{n("")}))}else n("")}))}function Fu(e,t){return new Promise((n=>{const{DD_BOT_TOKEN:r,DD_BOT_SECRET:i}=ju,o={url:`https://oapi.dingtalk.com/robot/send?access_token=${r}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(r){if(i){const e=require("crypto"),t=Date.now(),n=e.createHmac("sha256",i);n.update(`${t}\n${i}`);const r=encodeURIComponent(n.digest("base64"));o.url=`${o.url}&timestamp=${t}&sign=${r}`}wu.post(o).then((e=>{0===e.errcode?ra.info("ÈíâÈíâÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ„ÄÇ"):ra.info(`ÈíâÈíâÂèëÈÄÅÈÄöÁü•Â§±Ë¥•Ôºö${e.errmsg}`)})).catch((e=>{ra.info("ÈíâÈíâÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})),n("")}else n("")}))}function zu(e,t){return new Promise((n=>{const{QYWX_KEY:r}=ju,i={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${r}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};r&&wu.post(i).then((e=>{0===e.errcode?ra.info("‰ºÅ‰∏öÂæÆ‰ø°ÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ„ÄÇ"):ra.info(`‰ºÅ‰∏öÂæÆ‰ø°ÂèëÈÄÅÈÄöÁü•Â§±Ë¥•Ôºö${e.errmsg}`)})).catch((e=>{ra.info("‰ºÅ‰∏öÂæÆ‰ø°ÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})).finally((()=>{n("")})),n("")}))}function Mu(e){const{QYWX_AM:t}=ju,n=null==t?void 0:t.split(",");if(n[2]){const t=n[2].split("|");let r="";for(let n=0;n<t.length;n++){const i="Á≠æÂà∞Âè∑ "+(n+1);e.match(i)&&(r=t[n])}return r||(r=n[2]),r}return"@all"}function qu(e,t){return new Promise((n=>{const r=ju.QYWX_AM;if(r){const i=r.split(","),o={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${i[0]}`,corpsecret:`${i[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};wu.post(o).then((r=>{const o=t.replace(/\n/g,"<br/>"),a=JSON.parse(r).access_token;let s;switch(i[4]){case"0":s={msgtype:"textcard",textcard:{title:`${e}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"Êõ¥Â§ö"}};break;case"1":s={msgtype:"text",text:{content:`${e}\n\n${t}`}};break;default:s={msgtype:"mpnews",mpnews:{articles:[{title:`${e}`,thumb_media_id:`${i[4]}`,author:"Êô∫ËÉΩÂä©Êâã",content_source_url:"",content:`${o}`,digest:`${t}`}]}}}i[4]||(s={msgtype:"text",text:{content:`${e}\n\n${t}`}}),s={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${a}`,data:{touser:`${Mu(t)}`,agentid:`${i[3]}`,safe:"0",...s},headers:{"Content-Type":"application/json"}},wu.post(s).then((e=>{0===e.errcode?ra.info("ÊàêÂëòID:"+Mu(t)+"‰ºÅ‰∏öÂæÆ‰ø°Â∫îÁî®Ê∂àÊÅØÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ„ÄÇ"):ra.info(`‰ºÅ‰∏öÂæÆ‰ø°Â∫îÁî®Ôºö${e.errmsg}`)})).catch((e=>{ra.info("ÊàêÂëòID:"+Mu(t)+"‰ºÅ‰∏öÂæÆ‰ø°Â∫îÁî®Ê∂àÊÅØÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})).finally((()=>{n("")}))})).catch((e=>{ra.error("‰ºÅ‰∏öÂæÆ‰ø°Â∫îÁî®Ê∂àÊÅØÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ")}))}else n("")}))}function Gu(e,t,n={}){return new Promise((r=>{const{IGOT_PUSH_KEY:i}=ju;if(i){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(i))return ra.info("ÊÇ®ÊâÄÊèê‰æõÁöÑIGOT_PUSH_KEYÊó†Êïà"),void r("");const o={url:`https://push.hellyw.com/${i.toLowerCase()}`,data:`title=${e}&content=${t}&${Ho(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};wu.post(o).then((e=>{"string"==typeof e&&(e=JSON.parse(e)),0===e.ret?ra.info("iGotÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÊàêÂäüüéâ"):ra.info(`iGotÂèëÈÄÅÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•Ôºö${e.errMsg}`)})).catch((e=>{ra.info("iGotÂèëÈÄÅÈÄöÁü•Ë∞ÉÁî®APIÂ§±Ë¥•ÔºÅÔºÅ"),ra.info(e)})).finally((()=>{r("")}))}else r("")}))}function Ju(e,t){return new Promise((n=>{const{PUSH_PLUS_TOKEN:r,PUSH_PLUS_USER:i}=ju;if(r){t=t.replace(/[\n\r]/g,"<br>");const o={url:"https://www.pushplus.plus/send",data:{token:`${r}`,title:`${e}`,content:`${t}`,topic:`${i}`},headers:{"Content-Type":" application/json"},timeout:15e3};wu.post(o).then((e=>{200===e.code?ra.info(`push+ÂèëÈÄÅ${i?"‰∏ÄÂØπÂ§ö":"‰∏ÄÂØπ‰∏Ä"}ÈÄöÁü•Ê∂àÊÅØÂÆåÊàê„ÄÇ`):ra.info(`push+ÂèëÈÄÅ${i?"‰∏ÄÂØπÂ§ö":"‰∏ÄÂØπ‰∏Ä"}ÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•Ôºö${e.msg}`)})).catch((e=>{ra.info(`push+ÂèëÈÄÅ${i?"‰∏ÄÂØπÂ§ö":"‰∏ÄÂØπ‰∏Ä"}ÈÄöÁü•Ê∂àÊÅØÂ§±Ë¥•ÔºÅÔºÅ`),ra.info(e)})).finally((()=>{n("")}))}else n("")}))}var Ku=Object.freeze({__proto__:null,sendMessage:async function(e,t){ra.info("----„ÄêÊ∂àÊÅØÊé®ÈÄÅ„Äë----"),e=`Bili-${function(e=""){const t=e.length;return t<=3?e:`${e[0]}**${e[t-1]}`}(null==Ts?void 0:Ts.nickname)||$s.USERID}-${e}`,await async function(e,t,n={},r="\n\nÊú¨ÈÄöÁü• ByÔºöhttps://github.com/KudouRan/BiliTools"){Lu(),t+=r,await Promise.all([Nu(e,t),Ju(e,t)]),await Promise.all([Du(e,t,n),Bu(e,t),Fu(e,t),zu(e,t),qu(e,t),Gu(e,t,n),Ru(e,t),Au(e,t),Uu(e,t)])}(e,t,void 0,"")}});function Hu(){ra.info("ÂΩìÂâçÁâàÊú¨„Äêv0.5.220705-rc0„Äë")}function Wu(e,t){if(e.startsWith("v")&&(e=e.substring(1)),t.startsWith("v")&&(t=t.substring(1)),e===t)return!1;const n=e.split("."),r=t.split(".");for(let e=0;e<n.length;e++){const t=parseInt(n[e]),i=parseInt(r[e]);if(isNaN(t)||isNaN(i))return!0;if(t<i)return!0}return!1}var Yu=Object.freeze({__proto__:null,printVersion:async function(){let e="v0.5.220705-rc0";e.includes(".")?Hu():e=void 0;try{if(e||(e="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return f.readFileSync(u.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),ra.info(`ÂΩìÂâçÁâàÊú¨„Äê${e}„Äë`)),!e)return;const t=await async function(){const e={timeout:6e3};try{return(await Promise.any([wu.get("https://api.github.com/repos/KudouRan/BiliTools/releases/latest",e),wu.get("https://gitee.com/api/v5/repos/KudouRan/BiliTools/releases/latest",e)])).tag_name}catch(e){return}}();t&&Wu(e,t)&&ra.info(`ÂèØÊõ¥Êñ∞ÔºöÊúÄÊñ∞ÁâàÊú¨„Äê${t}„Äë`)}catch{}},printStrVersion:Hu,checkVersion:Wu});var Qu=Object.freeze({__proto__:null,default:async function(e,t,n,r,i=2){if(!e.TriggerName)return!1;if(!process.env.TENCENT_SECRET_ID||!process.env.TENCENT_SECRET_KEY)return ra.info("ÁéØÂ¢ÉÂèòÈáè‰∏çÂ≠òÂú®TENCENT_SECRET_IDÂíåTENCENT_SECRET_KEY"),!1;const o=await async function(){try{return await Promise.resolve().then((function(){return s(require("tencentcloud-sdk-nodejs"))}))}catch{ra.warn("tencentcloud-sdk-nodejs not foundÔºåËøêË°å cd src && yarn add tencentcloud-sdk-nodejs")}}();if(!o)return!1;const a=o.scf.v20180416.Client,c=t.function_name,u=e.TriggerName,f=new a({credential:{secretId:process.env.TENCENT_SECRET_ID,secretKey:process.env.TENCENT_SECRET_KEY},region:t.tencentcloud_region,profile:{httpProfile:{endpoint:"scf.tencentcloudapi.com"}}});async function l(){const e=r||Bo($s.dailyRunTime,"scf"),t={FunctionName:c,TriggerName:u,Type:"timer",TriggerDesc:e.value,Qualifier:"$DEFAULT"},i=await async function(){try{const{Triggers:e}=await f.ListTriggers({FunctionName:c});return-1!==(null==e?void 0:e.findIndex((e=>e.TriggerName===u)))}catch({code:e,message:t}){return ra.error(`Ëé∑ÂèñtriggerÂ§±Ë¥• ${e} => ${t}`),!1}}();if(ra.info(`‰øÆÊîπÊó∂Èó¥‰∏∫Ôºö${e.string}`),i){const e=await async function(e){try{return await f.DeleteTrigger(e)}catch({code:e,message:t}){return ra.warn(`Âà†Èô§triggerÂ§±Ë¥• ${e} => ${t}`),!1}}(t);if(!e)return}return!!await async function(e){const t=Ro();e.CustomArgument=JSON.stringify({...n,lastTime:t.getDate().toString()});try{return await f.CreateTrigger(e)}catch({code:e,message:t}){return ra.error(`ÂàõÂª∫triggerÂ§±Ë¥• ${e} => ${t}`),!1}}(t)}let d=!1;for(;!d&&i;)d=await l(),i--;return d}});var Vu=Object.freeze({__proto__:null,default:async function(e,t,n,r,i=2){if(!e.triggerName)return!1;if(!process.env.ALI_SECRET_ID||!process.env.ALI_SECRET_KEY)return ra.info("ÁéØÂ¢ÉÂèòÈáè‰∏çÂ≠òÂú®ALI_SECRET_IDÂíåALI_SECRET_KEY"),!1;const o=await async function(){try{return await Promise.resolve().then((function(){return s(require("@alicloud/fc2"))}))}catch{ra.warn("@alicloud/fc2 not foundÔºåËøêË°å yarn add @alicloud/fc2")}}();if(!o)return!1;const a=o.default,c=t.function.name,u=e.triggerName,f=t.service.name,l=new a(t.accountId,{accessKeyID:process.env.ALI_SECRET_ID,accessKeySecret:process.env.ALI_SECRET_KEY,region:t.region});async function d(){const e=r||Bo($s.dailyRunTime,"fc");return ra.info(`‰øÆÊîπÊó∂Èó¥‰∏∫Ôºö${e.string}`),!!await async function(e){const t=Ro(),r=`CRON_TZ=Asia/Shanghai ${e}`;try{return await l.updateTrigger(f,c,u,{triggerConfig:{cronExpression:r,payload:JSON.stringify({...n,lastTime:t.getDate().toString()})}})}catch(e){return ra.error(`Êõ¥Êñ∞triggerÂ§±Ë¥• ${e.message}`),!1}}(e.value)}let p=!1;for(;!p&&i;)p=await d(),i--;return p}});const Xu=vu({baseURL:ps,headers:{"user-agent":$s.userAgent}}),Zu=vu({baseURL:gs,headers:{Referer:fs,"user-agent":$s.userAgent}}),ef=vu({baseURL:ms,headers:{Referer:fs,"user-agent":$s.userAgent}}),tf=vu({baseURL:hs,headers:{"user-agent":$s.userAgent}}),nf=vu({baseURL:ys,headers:{"user-agent":$s.userAgent}}),rf=vu({baseURL:_s,headers:{"user-agent":$s.userAgent}});function of(){return ef.get("x/web-interface/nav",{headers:{Origin:os}})}function af(e=1,t=50,n=-10){return ef.get("x/relation/tag",{params:{tagid:n,pn:e,ps:t}})}function sf(e,t){return ef.post("x/relation/tags/addUsers?cross_domain=true",{fids:e,tagids:t,csrf:$s.BILIJCT},{headers:{Origin:ss}})}function cf(e,t,n=1){return ef.post("/x/web-interface/coin/add",{aid:e,multiply:t,selectLike:n,csrf:$s.BILIJCT})}function uf(e,t=1){return bu.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:e,multiply:t,csrf:$s.BILIJCT})}const ff="video",lf="audio",df="article";async function pf(e=!0){try{const t=$s.USERID,{data:n,message:r,code:i}=await(e?function(e=1,t=50){return af(e,t,-10)}():function(e,t=1,n=50,r="desc",i="attention"){return ef.get("x/relation/followings",{params:{vmid:e,pn:t,ps:n,order:r,order_type:i}})}(t)),o=e?n:n.list;if(!o||0===o.length)return{msg:"-1",data:{}};if(0===i){await Cs();const{mid:e}=Wo(o)||{};return await hf(e)}return{msg:e?`Êú™Ëé∑ÂèñÂà∞ÁâπÂà´ÂÖ≥Ê≥®ÂàóË°®: ${i}-${r}`:`Êú™Ëé∑ÂèñÂà∞ÂÖ≥Ê≥®ÂàóË°®: ${i}-${r}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function gf(){const e=Wo([1,3,4,5,160,22,119]);try{const{data:t,message:n,code:r}=await function(e=1,t=3){return ef.get("/x/web-interface/ranking/region",{params:{rid:e,day:t}})}(e,3);if(0==r){const{aid:e,title:n,author:r}=Wo(t);return{msg:"0",data:{id:Number(e),title:n,author:r}}}return{msg:`Êú™Ëé∑ÂèñÂà∞ÊéíË°å‰ø°ÊÅØ: ${r}-${n}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function mf(){const e=$s.coin.customizeUp;return 0===e.length?{msg:"-1",data:{}}:await hf(Wo(e))}async function hf(e){try{const{code:t,data:n,message:r}=await function(e){return ef.get(`/x/space/navnum?mid=${e}`)}(e);if(t)return{msg:`ÈÄöËøáuidËé∑ÂèñËßÜÈ¢ëÂ§±Ë¥•: ${t}-${r}`,data:{}};await Cs();const{video:i,audio:o,article:a}=n,s=function([e,t,n]){const r=e+t+n;if(!r)return;const i=Do(0,r-1);let o=i;if(i<e)return{coinType:ff,page:Uo(30,o+1),index:o%30};const a=e+t;return o=i-e,i<a?{coinType:lf,page:Uo(30,o+1),index:o%30}:(o=i-a,{coinType:df,page:Uo(12,o+1),index:o%12})}([i,o,a]);if(!s)return{msg:"Áî®Êà∑Ê≤°ÊúâÊäïÁ®ø",data:{}};const{coinType:c,page:u,index:f}=s,l={[ff]:yf,[lf]:_f,[df]:vf},d=await l[c](e,u,f);return d.message?{msg:d.message,data:{}}:{msg:"0",data:d}}catch(e){return ra.debug(e),{msg:e.message,data:{}}}}async function yf(e,t,n){const{code:r,data:i,message:o}=await function(e,t=30,n=1,r=""){return ef.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:r,pn:n,tid:0,ps:t,mid:e}})}(e,30,t);if(r)return{message:o};const{aid:a,title:s,author:c}=i.list.vlist[n];return{coinType:ff,id:a,title:s,author:c}}async function _f(e,t,n){const{code:r,data:i,msg:o}=await function(e,t=30,n=1){return ef.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:n,ps:t,uid:e}})}(e,30,t);if(r)return{message:o};const{data:a}=i,{id:s,uname:c,title:u}=a[n];return{coinType:lf,id:s,title:u,author:c}}async function vf(e,t,n){const{code:r,data:i,message:o}=await function(e,t=12,n=1){return ef.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:n,ps:t,mid:e},requestOptions:{isJsonp:!0}})}(e,12,t);if(r)return{message:o};const{articles:a}=i,{id:s,title:c,author:{name:u}}=a[n];return{coinType:df,id:s,title:c,author:u,mid:e}}const wf=function(){const e=[mf,pf,()=>pf(!1),gf];return $s.coin.customizeUp||e.shift(),e}();async function bf(e=0){wf.splice(0,Ts.currentStartFun+e);for(let e=0;e<wf.length;e++){const t=wf[e];let n=Number($s.coin.retryNum??4);for(n=n<1?1:n>8?8:n;n--;){await Cs();const e=await t();if("-1"===e.msg&&(n=0),"0"===e.msg)return e}n<=0&&(Ts.currentStartFun=e)}return{msg:"-1",data:{id:0}}}async function $f({id:e,coin:t=1,coinType:n="video",mid:r}){const i={[ff]:cf,[lf]:uf,[df]:(e,t=1)=>function(e,t,n=1){return ef.post("/x/web-interface/coin/add",{aid:t,upid:e,avtype:2,multiply:n,csrf:$s.BILIJCT})}(r,e,t)},o=await i[n](Number(e),t);return{code:o.code,message:o.message||o.msg}}async function Tf(){const e=await async function(){try{const{data:e,code:t}=await ef.get("x/web-interface/coin/today/exp");if(0===t)return e/10}catch(e){ra.debug(`Ëé∑ÂèñÊäïÂ∏ÅÊï∞ÈáèÂºÇÂ∏∏ ${e.message}`)}}();if(e)return e;const t=await async function(){try{const{code:e,message:t,data:n}=await ef.get("x/member/web/coin/log?jsonp=jsonp");if(0!==e)return void ra.warn(`Ëé∑ÂèñÊäïÂ∏ÅÊ∂àËÄóÁ°¨Â∏ÅÂ§±Ë¥•Ôºö${e} ${t}`);const r=n.list;if(!r||!r.length)return;const i=r.filter((e=>{if(-2!==e.delta&&-1!==e.delta)return!1;const{reason:t,time:n}=e;return t&&n&&t.startsWith("Áªô")&&t.endsWith("ÊâìËµè")?!!n.startsWith(Ao()):void 0})).reduce(((e,t)=>e+t.delta),0);return Math.abs(i)}catch(e){ra.debug(`Ëé∑ÂèñÊäïÂ∏ÅÊ∂àËÄóÁ°¨Â∏ÅÂºÇÂ∏∏ ${e.message}`)}}();return t}var Sf=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÊØèÊó•‰ªªÂä°ÂÆåÊàêÊÉÖÂÜµ„Äë----");try{const{data:e,message:t,code:n}=await ef.get("x/member/web/exp/reward");await Cs();const r=await Tf();if(0!=n)return void ra.warn(`Áä∂ÊÄÅËé∑ÂèñÂ§±Ë¥•: ${n} ${t}`);const i=Ts.money-$s.coin.stayCoins;let o=0;0===Ts.coinsTask?ra.info(`‰ªäÊó•ÊäïÂ∏ÅÊï∞ÈáèÔºö${r}ÔºåËøòÈúÄÊäïÂ∏Å0È¢óÔºåÁªèÈ™åÂ§ü‰∫ÜÔºå‰∏çÊÉ≥Êäï‰∫Ü`):i<=0?ra.info(`‰ªäÊó•ÊäïÂ∏ÅÊï∞ÈáèÔºö${r}ÔºåËøòÈúÄÊäïÂ∏Å0È¢óÔºåÁ°¨Â∏Å‰∏çÂ§ü‰∫ÜÔºå‰∏çÊäïÂ∏Å‰∫Ü`):i<Ts.coinsTask?(o=Ts.coinsTask-i,ra.info(`ÊäïÂ∏ÅÊï∞Èáè: ${r}ÔºåËøòÈúÄÊäïÂ∏ÅÊï∞Èáè: ${o}È¢ó;(ÁõÆÊ†á${Ts.coinsTask}È¢óÔºåÂøΩÁï•ÈÉ®ÂàÜÊäïÂ∏Å)`)):(o=Ts.coinsTask-r,ra.info(`ÊäïÂ∏ÅÊï∞Èáè: ${r}ÔºåËøòÈúÄÊäïÂ∏ÅÊï∞Èáè: ${o}È¢ó;(ÁõÆÊ†á${Ts.coinsTask}È¢ó)`)),Ts.coinsTask=o,ra.info("ÊØèÊó•ÂàÜ‰∫´: "+(e.share?"Â∑≤ÂÆåÊàê":"[Êú™ÂÆåÊàê]")),ra.info("ÊØèÊó•Êí≠Êîæ: "+(e.watch?"Â∑≤ÂÆåÊàê":"[Êú™ÂÆåÊàê]")),Ts.share=e.share,Ts.watch=e.watch}catch(e){ra.error(`Áä∂ÊÄÅËé∑ÂèñÂºÇÂ∏∏ ${e.message}`)}}});function Of(e=1,t=50,n=1){return Zu.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${e}&page_size=${t}&target_id=${n}`)}function Cf({ruid:e,gift_num:t,bag_id:n,gift_id:r,roomid:i}){const o=$s.BILIJCT,a=o,s={gift_id:r,ruid:e,gift_num:t,bag_id:n,biz_id:i,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:o,platform:"pc",biz_code:"Live",csrf_token:a,uid:$s.USERID};return Zu.post("/xlive/revenue/v2/gift/sendBag",s,{headers:{Origin:as}})}function kf(e){return Zu.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${e}`)}var If=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÁõ¥Êí≠Á≠æÂà∞„Äë----");try{const{data:e}=await Zu.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===e.status)return ra.info("Â∑≤Á≠æÂà∞ÔºåË∑≥ËøáÁ≠æÂà∞"),void ra.info(`Â∑≤ÁªèÁ≠æÂà∞${e.hadSignDays}Â§©Ôºå${e.specialText}`)}catch(e){ra.debug(`Áõ¥Êí≠Á≠æÂà∞Ôºå${e.message}`)}try{const{code:e,data:t,message:n}=await Zu.get("/xlive/web-ucenter/v1/sign/DoSign");0===e?ra.info(`Áõ¥Êí≠Á≠æÂà∞ÊàêÂäü: ${t.text}ÔºåÁâπÂà´‰ø°ÊÅØ: ${t.specialText}ÔºåÊú¨ÊúàÁ≠æÂà∞Â§©Êï∞: ${t.hadSignDays}Â§©;`):ra.warn(`Áõ¥Êí≠Á≠æÂà∞Â§±Ë¥•: ${e} ${n}`)}catch(e){ra.error(`Áõ¥Êí≠Á≠æÂà∞ÂºÇÂ∏∏: ${e.message}`)}}});async function Ef(e){if(await async function(){try{const e=await Tf(),t=$s.coin.targetCoins-e;Ts.coinsTask=t>0?t:0}catch(e){ra.debug(`Ëé∑ÂèñÊäïÂ∏ÅÊï∞ÈáèÂºÇÂ∏∏ ${e.message}`)}}(),Ts.coinsTask<=0||Ts.money<=0)return!0;const{data:t,msg:n}=await bf(e.priority);return null!=t&&t.id&&"0"==n?(await Cs(),await async function(e,t){const{id:n,title:r,author:i,coinType:o,mid:a}=e;try{const e=await $f({id:n,coinType:o,mid:a});if(0===e.code)Ts.money--,Ts.coinsTask--,t.num++,ra.info(`Áªô[${r}--up„Äê${i}„Äë]ÊäïÂ∏ÅÊàêÂäü`);else if(34005===e.code)t.fillCount++,ra.verbose(`ÂΩìÂâçÁ®ø‰ª∂[${n}]‰∏çËÉΩÂÜçÊäïÂ∏Å‰∫Ü`),t.fillCount>=3&&(ra.warn("Ëá™ÂÆö‰πâÁî®Êà∑ÁªÑÊäïÂ∏Å‰ºº‰πéÊ≤°ÊúâÂ∏ÅÂèØÊäï‰∫Ü"),t.priority++);else{if(-111===e.code||-104===e.code)return ra.warn(`${n} ${e.message} Êó†Ê≥ïÁªßÁª≠ËøõË°åÊäïÂ∏Å`),!0;if(t.eCount++,ra.warn(`Áªô${n}ÊäïÂ∏ÅÂ§±Ë¥• ${e.code} ${e.message}`),t.prevCode===e.code)return!0;t.prevCode=e.code}}catch(e){t.eCount++,ra.error(`ÊäïÂ∏ÅÂºÇÂ∏∏ ${e.message}`)}finally{await Cs(1500)}return!1}(t,e)):(e.eCount++,!1)}var Pf=Object.freeze({__proto__:null,default:async function(){if(ra.info("----„ÄêËßÜÈ¢ëÊäïÂ∏Å„Äë----"),!Ts.coinsTask)return void ra.info("Ë∑≥ËøáÊäïÂ∏ÅÔºå‰ªäÊó•Â∑≤ÂÆåÊàê");const e={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let t=!1;for(;Ts.coinsTask>0&&!t&&e.eCount<5&&e.num<5;)t=await Ef(e);e.eCount>=5&&ra.info("Âá∫Áé∞ÂºÇÂ∏∏/ÈîôËØØ5Ê¨°ÔºåËá™Âä®ÈÄÄÂá∫ÊäïÂ∏Å"),ra.info(`‰∏ÄÂÖ±ÊàêÂäüÊäïÂ∏Å${e.num}È¢ó`),ra.info(`Á°¨Â∏ÅËøòÂâ©${Ts.money}È¢ó`)}}),xf=ot,jf=cc,Lf=xt.f,Rf=xf("unscopables"),Af=Array.prototype;null==Af[Rf]&&Lf(Af,Rf,{configurable:!0,value:jf(null)});var Nf=Fe,Uf=cr,Df=tr,Bf=function(e){Af[Rf][e]=!0};Vr({target:"Array",proto:!0},{at:function(e){var t=Nf(this),n=Uf(t),r=Df(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:t[i]}}),Bf("at");var Ff=Vr,zf=K,Mf=tr,qf=Si,Gf=y,Jf=A("".charAt);Ff({target:"String",proto:!0,forced:Gf((function(){return"\ud842"!=="†Æ∑".at(-2)}))},{at:function(e){var t=qf(zf(this)),n=t.length,r=Mf(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:Jf(t,i)}});const Kf={"app-key":"android64",env:"prod","user-agent":$s.mobileUA};const Hf={ogvwatch:"ËßÇÁúãÊ≠£Áâá",tvodbuy:"Ë¥≠‰π∞ËßÜÈ¢ë",vipmallbuy:"Ë¥≠‰π∞ÂïÜÂìÅ",bonus:"Â§ß‰ºöÂëòÁ¶èÂà©",privilege:"ÊµèËßà‰ºöÂëòÊùÉÁõä","626act":"ÊµèËßà‚ÄúÊàëÁöÑÂìîÂì©Â∞èÂ±ã‚Äù",animatetab:"ÊµèËßàËøΩÁï™",filmtab:"ÊµèËßàÂΩ±ËßÜ",vipmallview:"ÊµèËßà‰ºöÂëòË¥≠"};async function Wf(){try{const{code:e,data:t,message:n}=await ef.get("x/vip_point/task/combine",{headers:Kf});return 0!==e&&ra.error(`Êü•ÁúãÂΩìÂâçÁä∂ÊÄÅÂ§±Ë¥•: ${e} ${n}`),t}catch(e){ra.error(e)}}async function Yf(){var e;const t=await Wf();if(!t)return;const{vip_info:{status:n,type:r},point_info:{point:i},task_info:o}=t;if(!async function(e,t,n){if(ra.info(`ÂΩìÂâçÁßØÂàÜ: ${n}`),0===e||0===t)return void ra.warn("ÂΩìÂâçÊó†Â§ß‰ºöÂëòÔºåÊó†Ê≥ïÁªßÁª≠ÊâßË°å‰ªªÂä°");return!0}(n,r,i))return;if(o.score_month>=o.score_limit)return void ra.info("Êú¨ÊúàÁßØÂàÜÂ∑≤È¢ÜÂèñÂÆå");-401!==await async function(e){if(!e||!e.length)return;const t=e.find((e=>e.is_today));if(!t)return;if(t.signed)return void ra.info("‰ªäÊó•Â∑≤Á≠æÂà∞ ‚úì");try{const{code:e,message:t}=await ef.post("pgc/activity/score/task/sign",Iu({csrf:$s.BILIJCT}),{headers:Kf});return 0===e?(ra.info("Á≠æÂà∞ÊàêÂäü ‚úì"),e):(ra.error(`Á≠æÂà∞Â§±Ë¥•: ${e} ${t}`),e)}catch(e){ra.error(e)}return-1}(null===(e=o.sing_task_item)||void 0===e?void 0:e.histories)?(await Cs(100,200),await async function(e){var t,n;function r(e){return!!e&&(!(e.vip_limit>Ts.vipType)&&(0===e.state||void 0))}const i=null===(t=e.modules.at(-1))||void 0===t||null===(n=t.common_task_item)||void 0===n?void 0:n.filter(r);if(!i||!i.length)return ra.info("Ê≤°ÊúâÈúÄË¶ÅÈ¢ÜÂèñÁöÑ‰ªªÂä°"),!1;return await async function(e){for(const t of e)await el(t),await Cs(100,300)}(i.map((e=>e.task_code))),ra.info("È¢ÜÂèñ‰ªªÂä°ÂÆåÊàê"),!0}(o)?(await Cs(100,200),await Qf(await Wf())):await Qf(t)):ra.error("Âá∫Áé∞ÈùûÊ≥ïËÆøÈóÆÂºÇÂ∏∏ÔºåÂèØËÉΩË¥¶Âè∑Â≠òÂú®ÂºÇÂ∏∏ÔºåÊîæÂºÉÂ§ßÁßØÂàÜ‰ªªÂä°")}async function Qf(e){var t,n;if(!e||!e.task_info)return;const r=null===(t=e.task_info.modules)||void 0===t||null===(n=t.at(-1))||void 0===n?void 0:n.common_task_item;if(!r)return void ra.info("Ê≤°ÊúâÈúÄË¶ÅÂÆåÊàêÁöÑÊØèÊó•‰ªªÂä°");const i=r.filter((e=>!(e.vip_limit>Ts.vipType)&&(!(e.complete_times>=e.max_times)&&(1===e.state||void 0))));await async function(e){for(const t of e){switch(t.task_code){case"ogvwatch":await Vf(t.complete_times);break;case"filmtab":await Xf("tv_channel","ÊµèËßàÂΩ±ËßÜÈ¢ëÈÅì");break;case"animatetab":await Xf("jp_channel","ÊµèËßàËøΩÁï™È¢ëÈÅì");break;case"vipmallview":await Zf()}await Cs(1e3,3e3)}}(i)}async function Vf(e){try{const t=function(e,t,n,r=[]){let i=Do(t,n);for(;r.includes(i);)i=Do(t,n);return Number(e+i)}("327",107,134,[122,123]),n=1===e?Do(905,1800):Do(1805,2e3);await function({start_ts:e,aid:t=243332804,cid:n=209599683,type:r=4,sub_type:i=5,dt:o=2,play_type:a=0,realtime:s=0,played_time:c=10,real_played_time:u=0,refer_url:f="",sid:l=33622,epid:d=327107}){return ef.post("x/click-interface/web/heartbeat",{start_ts:e,mid:$s.USERID,aid:t,cid:n,type:r,sub_type:i,dt:o,play_type:a,realtime:s,played_time:c,real_played_time:u,refer_url:f,bsource:"",sid:l,epid:d,spmid:"666.25",from_spmid:"..0.0",csrf:$s.BILIJCT})}({start_ts:Xo()-n,realtime:n,played_time:Do(1e3)+n,real_played_time:n,refer_url:"https://www.bilibili.com/bangumi/media/md28229051/",epid:t}),ra.info("ËßÇÁúãËßÜÈ¢ëÔºàË•øÊ∏∏ËÆ∞Ôºâ‰ªªÂä° ‚úì")}catch(e){ra.error(e),ra.error(`ËßÇÁúãËßÜÈ¢ë‰ªªÂä°Âá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`)}}async function Xf(e,t){try{await ef.post("pgc/activity/deliver/susWin/receive",Iu({csrf:$s.BILIJCT}),{headers:Kf}),Cs(1e3,2e3);const{code:r,message:i}=await(n=e,ef.post("pgc/activity/deliver/task/complete",Iu({csrf:$s.BILIJCT,position:n}),{headers:{...Kf,referer:ls}}));if(0!==r)return void ra.error(`${t}Â§±Ë¥•: ${r} ${i}`);ra.info(`${t}ÊØèÊó•‰ªªÂä° ‚úì`)}catch(e){ra.error(e),ra.error(`ÊØèÊó•‰ªªÂä°${t}Âá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`)}var n}async function Zf(){try{const{code:t,message:n}=await(e="hevent_oy4b7h3epeb",bu.post(`https://show.bilibili.com/api/activity/fire/common/event/dispatch?${Iu({csrf:$s.BILIJCT})}`,{eventId:e},{headers:{"content-type":"application/json; charset=utf-8",...Kf}}));if(0===t)return void ra.info("ÊµèËßà‰ºöÂëòË¥≠ÊØèÊó•‰ªªÂä° ‚úì");ra.error(`ÊµèËßà‰ºöÂëòË¥≠Â§±Ë¥•: ${t} ${n}`)}catch(e){ra.error(e),ra.error(`ÊØèÊó•‰ªªÂä°‰ºöÂëòË¥≠Âá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`)}var e}async function el(e){try{const{code:t,message:n}=await function(e="ogvwatch"){return ef.post("pgc/activity/score/task/receive",{csrf:$s.BILIJCT,ts:Xo(),taskCode:e},{http2:!0,headers:{"Content-Type":"application/json; charset=utf-8",Referer:ds,...Kf,navtive_api_from:"h5"}})}(e);if(0===t)return!0;ra.error(`È¢ÜÂèñ‰ªªÂä°${Hf[e]}Â§±Ë¥•: ${t} ${n}`)}catch(e){ra.error(e)}}var tl=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÂ§ß‰ºöÂëòÁßØÂàÜ„Äë----");try{if(0===Ts.vipType||0===Ts.vipStatus)return void ra.info("ÂΩìÂâç‰∏çÊòØÂ§ß‰ºöÂëòÔºåË∑≥Ëøá‰ªªÂä°");await Yf(),ra.info("Â§ß‰ºöÂëòÁßØÂàÜ‰ªªÂä°ÁªìÊùü")}catch(e){ra.error(`Â§ß‰ºöÂëòÁßØÂàÜ‰ªªÂä°ÂºÇÂ∏∏: ${e.message}`)}}});var nl=Object.freeze({__proto__:null,default:async function(){if(ra.info("----„ÄêÂàÜ‰∫´/Êí≠ÊîæËßÜÈ¢ë„Äë----"),Ts.share&&Ts.watch)return void ra.info("Â∑≤ÂÆåÊàêÔºåË∑≥ËøáÂàÜ‰∫´/Êí≠Êîæ");let e=0;try{let t=await bf();if("-1"===t.msg&&(t=await gf()),"0"!==t.msg)return ra.warn(`Ëé∑ÂèñËßÜÈ¢ëÂ§±Ë¥• ${t.msg}`),!1;{const{id:n,author:r,title:i}=t.data;e=n,ra.info(`Ëé∑ÂèñËßÜÈ¢ë: ${i} --up„Äê${r}„Äë`)}}catch(e){return ra.error(`Ëé∑ÂèñËßÜÈ¢ëÂá∫Áé∞ÂºÇÂ∏∏: ${e.message}`),!1}if(!Ts.share){await Cs();try{const{code:t,message:n}=await function(e){const t={csrf:$s.BILIJCT,aid:e};return ef.post("/x/web-interface/share/add",t)}(e);0===t?ra.info("ÂàÜ‰∫´ËßÜÈ¢ëÊàêÂäü!"):ra.warn(`ÂàÜ‰∫´ËßÜÈ¢ëÂ§±Ë¥•: ${t} ${n}`)}catch(e){ra.error(`ÂàÜ‰∫´ËßÜÈ¢ëÂºÇÂ∏∏: ${e.message}`)}}if(!Ts.watch){await Cs();try{const{code:r,message:i}=await(t=e,n=Do(4,60),ef.post("/x/click-interface/web/heartbeat",{aid:t,played_time:n}));0===r?ra.info("Êí≠ÊîæËßÜÈ¢ëÊàêÂäü!"):ra.warn(`Êí≠ÊîæËßÜÈ¢ëÂ§±Ë¥•: ${r} ${i}`)}catch(e){ra.error(`Êí≠ÊîæËßÜÈ¢ëÂºÇÂ∏∏: ${e.message}`)}}var t,n}});var rl=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÈì∂ÁìúÂ≠êÂÖëÊç¢Á°¨Â∏Å„Äë----");try{const{data:e,code:t,message:n}=await Zu.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&ra.info(`Ëé∑ÂèñÁìúÂ≠êËØ¶ÊÉÖÂ§±Ë¥• ${n}`),0===e.silver_2_coin_left)ra.info("‰ªäÊó•Â∑≤ÂÖëÊç¢‰∏ÄÊ¨°");else if(e.silver<700)ra.info("ÂÖëÊç¢Â§±Ë¥•Ôºå‰Ω†ÁìúÂ≠ê‰∏çÂ§ü‰∫Ü");else{const{message:e}=await Zu.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:$s.BILIJCT,csrf:$s.BILIJCT});ra.info(`ÂÖëÊç¢Á°¨Â∏ÅÔºö ${e}`),await Zu.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(e){ra.error(`Êìç‰ΩúÂºÇÂ∏∏ ${e.message}`)}}});let il;async function ol(){il=0;try{const{code:e,msg:t,data:n}=await function(e=1,t=50){return tf.post("twirp/user.v1.User/GetCoupons?platform=web",{not_expired:!0,page_num:e,page_size:t,tab_type:1})}();if(0!==e)return void ra.error(`Ëé∑ÂèñÊº´ËØªÂà∏Â§±Ë¥•Ôºö${e} ${t}`);const{user_coupons:r}=n;if(0===r.length)return void ra.info("Ê≤°ÊúâÊº´ËØªÂà∏ÔºåË∑≥Ëøá‰ªªÂä°");const i=r.filter((e=>0!==e.will_expire));return il=i.reduce(((e,t)=>e+t.remain_amount),0),il}catch(e){ra.error(`Ëé∑ÂèñÊº´ËØªÂà∏ÂºÇÂ∏∏: ${e}`)}}async function al(){try{const{code:e,msg:t,data:n}=await function(e=1,t=50,n=1){return tf.post("twirp/bookshelf.v1.Bookshelf/ListFavorite?platform=web",{page_num:e,page_size:t,order:n,wait_free:0})}();if(0===e)return n;ra.error(`Ëé∑ÂèñËøΩÊº´ÂàóË°®Â§±Ë¥•Ôºö${e} ${t}`)}catch(e){ra.error(`Ëé∑ÂèñËøΩÊº´ÂàóË°®ÂºÇÂ∏∏: ${e}`)}}async function sl(e){try{const{code:t,msg:n,data:r}=await function(e){return tf.post("twirp/comic.v1.Comic/ComicDetail",{device:"android",version:"4.16.0",comic_id:e})}(e);if(0!==t)return void ra.error(`Ëé∑ÂèñÊº´ÁîªËØ¶ÊÉÖÂ§±Ë¥•Ôºö${t} ${n}`);if(!r||!r.ep_list)return;let i=r.ep_list;return 0!==r.disable_coupon_amount&&(i=i.slice(0,i.length-r.disable_coupon_amount)),i.filter((e=>e.is_locked))}catch(e){ra.error(`Ëé∑ÂèñÊº´ÁîªËØ¶ÊÉÖÂºÇÂ∏∏: ${e}`)}}async function cl(e){try{const{code:t,msg:n,data:r}=await function(e){return tf.post("twirp/comic.v1.Comic/GetEpisodeBuyInfo?platform=web",{ep_id:e})}(e);if(0!==t)return void ra.error(`Ëé∑ÂèñË¥≠‰π∞‰ø°ÊÅØÂ§±Ë¥•Ôºö${t} ${n}`);if(!r)return;if(!r.allow_coupon)return void ra.info("Êº´Áîª‰∏çÊîØÊåÅÊº´ËØªÂà∏");if(0===r.recommend_coupon_id||0===r.remain_coupon)return il=0,void ra.info("Ê≤°ÊúâË∂≥Â§üÁöÑÊº´ËØªÂà∏‰∫Ü");if(!r.remain_lock_ep_num)return;return r.recommend_coupon_id}catch(e){ra.error(`Ëé∑ÂèñË¥≠‰π∞‰ø°ÊÅØÂºÇÂ∏∏: ${e}`)}}async function ul(e){try{const t=await cl(e);if(!t)return!0;const{code:n,msg:r}=await function(e,t,n=2,r=0){return tf.post("twirp/comic.v1.Comic/BuyEpisode?&platform=web",{buy_method:n,ep_id:e,coupon_id:t,auto_pay_gold_status:r})}(e,t);if(0!==n)return void ra.error(`Ë¥≠‰π∞Êº´ÁîªÂ§±Ë¥•Ôºö${n} ${r}`);il--,ra.info("Ë¥≠‰π∞Êº´ÁîªÊàêÂäü")}catch(e){ra.error(`Ë¥≠‰π∞Êº´ÁîªÂºÇÂ∏∏: ${e}`)}}async function fl(e){try{const{code:t,msg:n,data:r}=await function(e,t=1,n=9){return tf.post("twirp/comic.v1.Comic/Search?device=pc&platform=web",{keyword:e,page_num:t,page_size:n})}(e);if(0===t)return r;ra.error(`ÊêúÁ¥¢Êº´ÁîªÂ§±Ë¥•Ôºö${t} ${n}`)}catch(e){ra.error(`ÊêúÁ¥¢Êº´ÁîªÂºÇÂ∏∏: ${e}`)}}async function ll(e){const t=await sl(e);if(!t||0===t.length)return!1;for(let e=0;e<t.length;e++)if(await Cs(100),await ul(t[e].id))return!0}async function dl(){il=await ol(),il<1?ra.info("Ê≤°ÊúâÂç≥Â∞ÜËøáÊúüÁöÑÊº´ËØªÂà∏ÔºåË∑≥Ëøá‰ªªÂä°"):(await async function(){const{mc:e}=$s.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(il<=0)return;const n=e[t];await ll(n)}}(),await async function(){const{name:e}=$s.manga;if(0!==e.length)for(let t=0;t<e.length;t++){if(il<=0)return;const n=e[t],r=await fl(n);if(!r||0===r.list.length)continue;const i=r.list.find((e=>e.title===n));i&&await ll(i.id)}}(),await async function(){const{love:e}=$s.manga;if(!e||il<=0)return;const t=await al();if(t&&0!==t.length)for(let e=0;e<t.length;e++){if(il<=0)return;const n=t[e];await ll(n.comic_id)}}())}async function pl(){try{const{code:e}=await function(e="android"){return tf.post("twirp/activity.v1.Activity/ClockIn",{platform:e})}();0==e?ra.info("Êº´ÁîªÁ≠æÂà∞ÊàêÂäü"):ra.warn("Êº´ÁîªÁ≠æÂà∞Â§±Ë¥•")}catch(e){const{status:t,statusCode:n}=e.response||{};400===t||400===n?ra.info("Â∑≤ÁªèÁ≠æÂà∞Ëøá‰∫ÜÔºåË∑≥Ëøá‰ªªÂä°"):ra.error(`Êº´ÁîªÁ≠æÂà∞ÂºÇÂ∏∏ ${e.message}`)}}var gl=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÊº´ÁîªÁ≠æÂà∞„Äë----"),ra.warn("Êº´ÁîªÁ≠æÂà∞‰ªªÂä°ÁßªÂä®Âà∞‰∫ÜÊº´Áîª‰ªªÂä°‰∏≠ÔºåËØ∑‰øÆÊîπ‰∏∫Êñ∞ÁöÑ‰ªªÂä°"),await pl()}});var ml=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÊº´Áîª‰ªªÂä°„Äë----");const{manga:e}=$s;try{e.sign&&(ra.info("ÂºÄÂßãÁ≠æÂà∞"),await pl());e.buy&&function(){const{buyWeek:e,buyInterval:t}=$s.manga;if(!e||0===e.length)return!1;if(1===t)return!0;const n=new Date,r=n.getDay(),i=n.getDate();return e.includes(r)||i%t-1==0}()?(ra.info("ÂºÄÂßãË¥≠‰π∞Êº´Áîª"),await dl()):ra.info("ÈùûË¥≠‰π∞Êº´ÁîªÊó∂Èó¥Ôºå‰∏çË¥≠‰π∞")}catch(e){ra.error(`Êº´Áîª‰ªªÂä°ÂºÇÂ∏∏: ${e}`)}}});async function hl(){try{const{data:e,code:t,message:n}=await nf.get("/link_group/v1/member/my_groups");return 0===t?(null==e?void 0:e.list)||[]:(ra.warn(`Ëé∑ÂèñËá™Â∑±ÁöÑÂ∫îÊè¥Âõ¢ÂºÇÂ∏∏Â§±Ë¥•: ${n}`),[])}catch(e){ra.error(`Ëé∑ÂèñËá™Â∑±ÁöÑÂ∫îÊè¥Âõ¢ÂºÇÂ∏∏: ${e}`)}}async function yl(e,t){try{const{data:i,code:o,message:a}=await(n=e.group_id,r=e.owner_uid,nf.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:n,owner_id:r}}));if(0!==o)return void ra.warn(`[${e.group_name}]Á≠æÂà∞Â§±Ë¥• ${a}`);0===i.status?t.value++:ra.verbose(`Á≠æÂà∞Â§±Ë¥•: ${i.status} ${a}`)}catch(e){ra.error(`Á≠æÂà∞ÂºÇÂ∏∏ ${e.message}`)}finally{await Cs(400,1e3)}var n,r}var _l=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÂ∫îÊè¥Âõ¢Á≠æÂà∞„Äë----");const e=await hl();await Cs();const t={value:0};for(let n=0;n<e.length;n++){const r=e[n];await yl(r,t)}ra.info(`Á≠æÂà∞ÁªìÊùüÔºåÊàêÂäü${t.value}/${e.length}`)}});function vl({buvid:e=zo(37).toUpperCase(),gu_id:t=zo(43).toLocaleUpperCase(),visit_id:n=zo(32).toLocaleLowerCase(),uuid:r=Lo(),click_id:i=Lo(),room_id:o,up_id:a,uid:s,up_level:c=40,up_session:u="",parent_id:f=11,area_id:l=376}){const d={platform:"android",uuid:r,buvid:e,seq_id:"1",room_id:o,parent_id:f,area_id:l,timestamp:String(parseInt(String((new Date).getTime()/1e3))-60),secret_key:"axoaadsffcazxksectbbb",watch_time:"60",up_id:a||s,up_level:c,jump_from:"30000",gu_id:t,play_type:"0",play_url:"",s_time:"0",data_behavior_id:"",data_source_id:"",up_session:u,visit_id:n,watch_status:"",click_id:i,session_id:"-99998",player_type:"0",client_ts:String(parseInt(String((new Date).getTime()/1e3)))},p={...d,ts:parseInt(String((new Date).getTime()/1e3)),client_sign:xu(d),csrf_token:$s.BILIJCT,csrf:$s.BILIJCT};return rf.post("xlive/data-interface/v1/heartbeat/mobileHeartBeat",p)}const wl=["(‚åí‚ñΩ‚åí)","ÔºàÔø£‚ñΩÔø£Ôºâ","(=„Éªœâ„Éª=)","(ÔΩÄ„Éªœâ„Éª¬¥)","(„ÄúÔø£‚ñ≥Ôø£)„Äú","(ÔΩ•‚àÄÔΩ•)","(¬∞‚àÄ¬∞)Ôæâ","(Ôø£3Ôø£)","‚ïÆ(Ôø£‚ñΩÔø£)‚ï≠","_(:3„Äç‚à†)_","( ¬¥_„ÇùÔΩÄ)","‚Üê_‚Üê","‚Üí_‚Üí","(<_<)","(>_>)","(;¬¨_¬¨)","(Ôæü–îÔæü‚â°Ôæü–¥Ôæü)!?","Œ£(Ôæü–¥Ôæü;)","Œ£( Ôø£‚ñ°Ôø£||)","(¬¥ÔºõœâÔºõ`)","Ôºà/T–îT)/","(^„Éªœâ„Éª^ )","(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)","(‚óèÔø£(ÔΩ¥)Ôø£‚óè)","Œµ=Œµ=(„Éé‚âß‚àá‚â¶)„Éé","(¬¥ÔΩ•_ÔΩ•`)","(-_-#)","ÔºàÔø£„Å∏Ôø£Ôºâ","(Ôø£Œµ(#Ôø£) Œ£","„ÉΩ(`–î¬¥)Ôæâ","Ôºà#-_-)‚îØ‚îÅ‚îØ","(‚ïØ¬∞Âè£¬∞)‚ïØ(‚î¥‚Äî‚î¥","‚Üê‚ó°‚Üê","( ‚ô•–¥‚ô•)","Œ£>‚Äï(„ÄÉ¬∞œâ¬∞„ÄÉ)‚ô°‚Üí","‚ÅÑ(‚ÅÑ ‚ÅÑ‚Ä¢‚ÅÑœâ‚ÅÑ‚Ä¢‚ÅÑ ‚ÅÑ)‚ÅÑ","(‚ï¨Ôæü–¥Ôæü)‚ñÑÔ∏ª‚îª‚î≥‚ïê‰∏Ä","ÔΩ•*ÔΩ•:‚â°(„ÄÄŒµ:)","(Ê±ó)","(Ëã¶Á¨ë)"].concat("1","2","3","4","5","6","7","8","9","Á≠æÂà∞","ÂìàÂìà"),bl=new na({console:"debug",file:"debug",push:"warn",payload:Ts.nickname},"live");async function $l(){let e=99,t=0;const n=[];try{for(;t<e;){const{code:r,message:i,data:o}=await Of(t+1,50,$s.USERID);if(0!==r)return ra.verbose(`Ëé∑ÂèñÂããÁ´†‰ø°ÊÅØÂ§±Ë¥• ${r} ${i}`),null;if(!o)return n;e=o.page_info.total_page,t=o.page_info.current_page,n.push(...o.list,...o.special_list)}return n}catch(e){return ra.error(`Ëé∑ÂèñÂããÁ´†ÂºÇÂ∏∏ ${e.message}`),null}}function Tl({room_info:e,medal:t}){if(null==e||!e.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;if(t.today_feed>=1300)return!1;const{whiteList:n,blackList:r}=$s.intimacy;return n&&n.length?!(!n.includes(e.room_id)&&!n.includes(t.target_id)):!r||!r.includes(e.room_id)&&!r.includes(t.target_id)}async function Sl(e,t){const n=wl[Do(wl.length-1)];try{const{code:r,message:i}=await function(e,t){const n=$s.BILIJCT,r=n;return t||(t=Do(10).toString()),Zu.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:e,bubble:0,csrf:n,csrf_token:r})}(e,n);return 0===r||(11e3===r?(ra.warn(`„Äê${t}„Äë${e}-ÂèØËÉΩÊú™ÂºÄÂêØËØÑËÆ∫`),!1):(ra.warn(`„Äê${t}„Äë${e}-ÂèëÈÄÅÂ§±Ë¥• ${i}`),ra.verbose(`code: ${r}`),!1))}catch(e){ra.verbose(`ÂèëÈÄÅÂºπÂπïÂºÇÂ∏∏ ${e.message}`)}}async function Ol(e){try{const{code:n,message:r,data:i}=await(t=e,Zu.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:$s.BILIJCT,csrf_token:$s.BILIJCT,visit_id:""}));if(0===n)return i;ra.info(`„Äê${e}„ÄëÁõ¥Êí≠Èó¥ÂàÜ‰∫´Â§±Ë¥• ${n} ${r}`)}catch(t){ra.warn(`ÂàÜ‰∫´Áõ¥Êí≠Èó¥ [${e}] ÂºÇÂ∏∏ ${t.message}`)}var t}async function Cl(e){try{const{code:n,message:r,data:i}=await(t=e,Zu.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:$s.BILIJCT,csrf_token:$s.BILIJCT}));if(0===n)return i;ra.info(`„Äê${e}„ÄëÁõ¥Êí≠Èó¥ÁÇπËµûÂ§±Ë¥• ${n} ${r}`)}catch(e){ra.warn(`ÁÇπËµûÁõ¥Êí≠Èó¥ÂºÇÂ∏∏ ${e.message}`)}var t}async function kl(e,t){if(!(t.value>=31))try{const{code:n,message:r}=await vl(e);if(0!==n)return void ra.warn(`Áõ¥Êí≠Èó¥ÂøÉË∑≥Â§±Ë¥• ${n} ${r}`);t.value++,bl.info(`Áõ¥Êí≠Èó¥ÂøÉË∑≥ÊàêÂäü ${e.uname}Ôºà${t.value}/31Ôºâ`)}catch(e){bl.error(e),ra.error(`Áõ¥Êí≠Èó¥ÂøÉË∑≥ÂºÇÂ∏∏ ${e.message}`)}}async function Il(){const e=(t=await $l())&&0!==t.length?t.filter(Tl):[];var t;return await Promise.allSettled([El(e),Pl(e)])}async function El(e){for(let t=0;t<e.length;t++){const n=e[t];await jl(n)}}async function Pl(e){if(0===e.length)return;const{liveHeart:t}=$s.intimacy;var n;return t?_o()?await(n=e,Promise.all(n.map((e=>async function(e,t,n){for(let r=0;r<31;r++){const{medal:r,anchor_info:i,room_info:o}=e;await kl({up_id:r.target_id,room_id:o.room_id,uname:i.nick_name,...t},n),await Cs(6e4)}}(e,xl(),{value:0}))))):new Promise((t=>function(e,t){for(const e of t){const t={value:0},r={value:void 0},i=xl();n(e,i,t,r),r.value=setInterval(n,6e4,e,i,t,r),ks(50,150)}async function n({medal:e,anchor_info:t,room_info:n},r,i,o){await kl({up_id:e.target_id,room_id:n.room_id,uname:t.nick_name,...r},i),i.value>=31&&o&&o.value&&clearInterval(o.value)}e("Áõ¥Êí≠Èó¥ÂøÉË∑≥")}(t,e))):void 0}function xl(){return{buvid:zo(37).toUpperCase(),gu_id:zo(43).toLocaleUpperCase(),visit_id:zo(32).toLocaleLowerCase(),uuid:Lo(),click_id:Lo()}}async function jl(e){const{room_info:t,anchor_info:n}=e;if(!t||!n)return;const{liveLike:r,liveSendMessage:i,liveShare:o}=$s.intimacy,a=n.nick_name,s=t.room_id;(r||i||o)&&(i&&(bl.verbose(`„Äê${a}„ÄëÂºÄÂßãÂèëÈÄÅÁõ¥Êí≠ÂºπÂπï`),await Sl(s,a)),o&&async function(){await Cs(100,300);for(let e=0;e<5;e++)bl.verbose(`ÂàÜ‰∫´ [${a}] Áõ¥Êí≠Èó¥`),await Ol(s),await Cs(4e3)}().catch((e=>ra.error(e))),r&&async function(){await Cs(100,300);for(let e=0;e<3;e++)bl.verbose(`Áªô [${a}] Áõ¥Êí≠Èó¥ÁÇπËµû`),await Cl(s),await Cs(6500)}().catch((e=>ra.error(e))),await Cs(22e3))}var Ll,Rl=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÂèëÈÄÅÁõ¥Êí≠ÂºπÂπï„Äë----"),ra.info("ËØ•ÂáΩÊï∞Âç≥Â∞ÜÂ∫üÂºÉÔºåËØ∑‰ΩøÁî® liveIntimacy Êõø‰ª£");try{const e=await $l(),t=e.length;let n=0,r=0;ra.info(`‰∏ÄÂÖ±ÈúÄË¶ÅÂèëÈÄÅ${t}‰∏™Áõ¥Êí≠Èó¥`),ra.verbose("ÊâÄÈúÄÊó∂Èó¥ÂèØËÉΩÂæàÈïøÔºåËØ∑ËÄêÂøÉÁ≠âÂæÖ");for(let i=0;i<t;i++){const{room_info:o,anchor_info:a,medal:s}=e[i];null!=o&&o.room_id?100===s.today_feed||s.level>=20?r++:(await Sl(o.room_id,a.nick_name)&&n++,i<t-1&&await Cs(Do(1e4,25e3))):(ra.info(`„Äê${a.nick_name}„ÄëÊ≤°ÊúâÁõ¥Êí≠Èó¥Âì¶`),r++)}ra.info(`ÊàêÂäüÂèëÈÄÅ${n}‰∏™ÂºπÂπïÔºåË∑≥Ëøá${r}‰∏™`)}catch(e){ra.error(`Áõ¥Êí≠Èó¥ÂèëÈÄÅÂºπÂπïÂºÇÂ∏∏: ${e.message}`)}}});async function Al(){try{const{data:e,message:t,code:n}=await of();if(0!==n)return void ra.warn(`Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•Ôºö${n} ${t}`);!function(e){var t;Ts.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0}(e)}catch(e){ra.error(`Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂºÇÂ∏∏Ôºö${e.message}`)}}!function(e){e[e["ÊàêÂäü"]=4]="ÊàêÂäü",e[e["‰Ωé‰∫é20ÁîµÊ±†"]=-2]="‰Ωé‰∫é20ÁîµÊ±†",e[e["BÂ∏Å‰∏çË∂≥"]=-4]="BÂ∏Å‰∏çË∂≥"}(Ll||(Ll={}));var Nl=Object.freeze({__proto__:null,default:async function(){if(ra.info("----„ÄêÁªôÁõÆÊ†áÂÖÖÁîµ„Äë----"),await Al(),await Cs(),function(){const e=Ro(),t=e.getDate(),n=jo(e);let r=$s.charge.presetTime;return Eo(r)||(r=[r]),Ts.bCoinCouponBalance<2?(ra.info(`Ââ©‰ΩôÂà∏‰∏∫${Ts.bCoinCouponBalance}Ôºå‰∏çË∂≥2Ë∑≥ËøáÂÖÖÁîµ`),!1):n===t?(ra.info("‰ªäÂ§©ÊòØÊúÄÂêé‰∏ÄÂ§©‰∫Ü"),!0):!!r.some((e=>e===t))||(ra.info("‰∏çÂú®È¢ÑËÆæÊó∂Èó¥Ôºå‰∏çÁ¨¶ÂêàÊù°‰ª∂"),!1)}())try{const e=Ts.bCoinCouponBalance||0,t=$s.charge.mid;let n=0;ra.info(`b Â∏ÅÂà∏‰ΩôÈ¢ù${e}`);const r=async()=>{const{code:n,message:r,data:i}=await function(e=50,t=!0,n=$s.USERID,r="up",i=n){return ef.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:$s.BILIJCT,bp_num:e,is_bp_remains_prior:t,up_mid:n,otype:r,oid:i})}(e,!0,t);0===n?(ra.info(`ÁõÆÊ†á„Äê${t}„Äë${Ll[i.status]}`),i.status===Ll["ÊàêÂäü"]&&(Ts.chargeOrderNo=i.order_no,await Cs(),await async function(){try{if(!Ts.chargeOrderNo)return!1;const e=vo[Do(0,vo.length-1)],{code:t}=await function(e,t="ÊîØÊåÅÂ§ß‰Ω¨‰∏ÄÊ≥¢"){return ef.post("/x/ugcpay/trade/elec/message",{csrf:$s.BILIJCT,message:t,order_id:e})}(Ts.chargeOrderNo,e);0===t&&ra.info("ÁïôË®ÄÊàêÂäüÔºÅ")}catch{}}())):ra.warn(`ÂÖÖÁîµÂ§±Ë¥•Ôºö${n} ${r}`)};for(Ts.chargeOrderNo="";!(Ts.chargeOrderNo||(await r(),await Cs(),n++>2)););}catch(e){ra.error(`ÂÖÖÁîµÂá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`)}}});async function Ul(){try{const{data:e,code:t,message:n}=await ef.get("/x/vip/privilege/my",{headers:{origin:os,referer:fs}});if(0!==t)return void ra.info(`Ëé∑ÂèñÈ¢ÜÂèñÁä∂ÊÄÅÂ§±Ë¥•Ôºö${t} ${n}`);const{list:r}=e,i=r.filter((e=>0===e.state));return 0===i.length?void ra.info("ÊöÇÊó†ÂèØÈ¢ÜÂèñÊùÉÁõäÔºàÂ∑≤È¢ÜÂèñÔºâ"):i}catch(e){ra.error(`Ëé∑ÂèñÈ¢ÜÂèñÁä∂ÊÄÅÂá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`)}}async function Dl(e){try{const t=function(e){switch(e){case 1:return"B Â∏ÅÂà∏";case 2:return"‰ºöÂëòË¥≠‰ºòÊÉ†Âà∏";case 3:return"Êº´ËØªÂà∏";case 4:return"‰ºöÂëòË¥≠ËøêË¥πÂà∏";default:return"Êú™Áü•"}}(e),{code:n,message:r}=await function(e=1){return ef.post("/x/vip/privilege/receive",{csrf:$s.BILIJCT,type:e},{headers:{origin:us,referer:fs}})}(e);let i="ÊàêÂäü";return 0!==n&&(i=`Â§±Ë¥• ${r}`),ra.info(`È¢ÜÂèñ${t}${i}`),!0}catch(e){ra.error(`È¢ÜÂèñÊùÉÁõäÂá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`),ra.error(e)}return!1}async function Bl(e){if(![1,3].includes(e))return;let t=0,n=!1;for(;!(n||(n=await Dl(e),t>2));)t++;return n}var Fl=Object.freeze({__proto__:null,default:async function(){try{if(ra.info("----„ÄêÈ¢ÜÂèñÂ§ß‰ºöÂëòÊùÉÁõä„Äë----"),0===Ts.vipStatus||0===Ts.vipType)return void ra.info("ÊÇ®Ëøò‰∏çÊòØÂ§ß‰ºöÂëòÔºåÊó†Ê≥ïÈ¢ÜÂèñÊùÉÁõä");const e=await Ul();if(!e||0===e.length)return;for(let t=0;t<e.length;t++){await Cs(100);const n=e[t];await Bl(n.type)}}catch(e){ra.error(`È¢ÜÂèñÂ§ß‰ºöÂëòÊùÉÁõäÂá∫Áé∞ÂºÇÂ∏∏Ôºö${e.message}`),ra.error(e)}}});function zl(e,t,n,r){const i=$s.BILIJCT,o={is_fav:0,main_id:t,oid:e,detail_id:n,count:r,csrf:i,csrf_token:i};return ef.post("/x/esports/guess/add",o)}function Ml(){const{coin:e,match:t}=$s;return Ts.money-t.coins<e.stayCoins&&(ra.info(`ÈúÄË¶Å‰øùÁïô${e.stayCoins}‰∏™Á°¨Â∏ÅÔºå‰ªªÂä°ÁªìÊùü`),!0)}var ql=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêËµõ‰∫ãÁ°¨Â∏ÅÁ´ûÁåú„Äë----");const{match:e}=$s;if(e.coins<=0)return void ra.info("Á°¨Â∏ÅÊï∞Èáè‰∏çËÉΩÂ∞è‰∫é 0");if(Ml())return;const t=await async function(){try{const{code:e,message:t,data:{list:n,page:r}}=await function(e="",t=""){return ef.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${e}&etime=${t}`)}();return 0!==e?void ra.warn(`Ëé∑ÂèñËµõ‰∫ãÈîôËØØ ${e} ${t}`):0===r.total?(ra.info("‰ªäÊó•Â∑≤ÁªèÊó†Ê≥ïËé∑ÂèñËµõ‰∫ã"),null):n}catch(e){ra.debug(e.message)}}();if(await Cs(),!t)return;const n=await async function(e){let t=0;try{for(const n of e){const{contest:e,questions:r}=n,i=e.id,[{id:o,title:a,details:s,is_guess:c}]=r,[u,f]=s;if(Ml())return t;if(c)continue;ra.info(`${a} <=> ${u.odds}:${f.odds}`);const l=u.odds>f.odds,{match:d}=$s;let p;p=d.selection>0?l?f:u:l?u:f,ra.info(`È¢ÑÊµã[ ${p.option} ] ${d.coins} È¢óÁ°¨Â∏Å`),await Cs();const{code:g}=await zl(i,o,p.detail_id,d.coins);0!==g?ra.info("È¢ÑÊµãÂ§±Ë¥•"):(t++,Ts.money-=d.coins)}}catch(e){console.warn(e.message)}return t}(function(e,t){return e.filter((e=>{const{questions:n}=e,[{details:r,is_guess:i}]=n;if(i)return!1;const[o,a]=r;return Math.abs(o.odds-a.odds)>=t}))}(t,e.diff));ra.info(`„ÄêÁ´ûÁåúÁªìÊùü„Äë‰∏ÄÂÖ±ÂèÇ‰∏é${n}Ê¨°È¢ÑÊµã`)}});async function Gl(){const{data:e,code:t}=await af(1,1,0);if(0!==t)throw new Error(`Ëé∑ÂèñÊúÄÂêé‰∏Ä‰∏™ÂÖ≥Ê≥®Â§±Ë¥•: ${t}`);return e[0]}async function Jl(e){const{data:t,code:n}=await ef.get("x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===n)return t.find((t=>t.name===e));ra.warn(`Ëé∑ÂèñÂàÜÁªÑÂàóË°®Â§±Ë¥•: ${n}`)}async function Kl(e){const t=await Jl(e);if(t)return t.tagid;await Cs(300);const{data:n,code:r,message:i}=await(o=e,ef.post("x/relation/tag/create",{tag:o,jsonp:"jsonp",csrf:$s.BILIJCT}));var o;if(22106===r){await Cs(300);const t=await Jl(e);return t&&t.tagid}return 0!==r&&ra.warn(`ÂàõÂª∫ÂàÜÁªÑÂ§±Ë¥•: ${r}-${i}`),n.tagid}async function Hl(e,t="Â§©ÈÄâÊó∂Âàª"){if(0===e.length)return;const n=await Kl(t);if(n)for(const t of e){const{code:e,message:r}=await sf(t.mid,n);0!==e&&ra.warn(`ÁßªÂä®„Äê${t.uname}„ÄëÂ§±Ë¥•: ${e}-${r}`),await Cs(500,1300)}}async function Wl(e,t,n,r=1){if(e.length>t.length)return;const{data:i,code:o,message:a}=await af(r,20,0);if(0===o){for(const{mid:r,uname:o}of i){if(e.length>=t.length)return;if(r===n)return;(t.includes(r)||t.includes(o))&&e.push({mid:r,uname:o})}if(!(i.length<20))return await Wl(e,t,n,r+1)}else ra.warn(`Ëé∑ÂèñÂÖ≥Ê≥®Áî®Êà∑Â§±Ë¥•: ${o}-${a}`)}const Yl=0,Ql=1,Vl=5,Xl=1,Zl=504,ed=1096;let td;async function nd(){try{const{data:e,code:t,message:n}=await Zu.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&ra.info(`Ëé∑ÂèñÁõ¥Êí≠ÂàÜÂå∫Â§±Ë¥•: ${t}-${n}`),e.data.map((e=>e.list)).map((e=>e.map((e=>({areaId:e.id,parentId:e.parent_id})))))}catch(e){throw ra.error(`Ëé∑ÂèñÁõ¥Êí≠ÂàÜÂå∫ÂºÇÂ∏∏: ${e.message}`),e}}async function rd(e,t,n=1,r="lottery"){try{await Cs(100);const{data:i,code:o,message:a}=await function(e,t,n=1){return Zu.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${e}&area_id=${t}&page=${n}`)}(t,e,n);return 0!==o&&ra.info(`Ëé∑ÂèñÁõ¥Êí≠Èó¥ÂàóË°®Â§±Ë¥•: ${o}-${a}`),function(e){const t=[],n=[];return e.forEach((e=>{const r=e.pendant_info[2];r&&(r.pendent_id===Zl?t.push(e):r.pendent_id===ed&&n.push(e))})),{lotteryTime:t,lotteryPacket:n}}(i.list)["lottery"===r?"lotteryTime":"lotteryPacket"]}catch(e){throw ra.error(`Ëé∑ÂèñÁõ¥Êí≠Èó¥ÂàóË°®ÂºÇÂ∏∏: ${e.message}`),e}}async function id(e,t,n=1){const r=await rd(e,t,n),i=[];for(const e of r){const t=await od(e);t&&(i.push({...t,uid:e.uid,uname:e.uname}),await Cs(100))}return i}async function od(e){const{blackUid:t}=$s.lottery;if(t.includes(e.uid))return void ra.info(`Ë∑≥ËøáÈªëÂêçÂçïÁî®Êà∑: ${e.uname}`);let n,r,i;try{({data:r,code:n,message:i}=await kf(e.roomid))}catch(t){return void ra.info(`Áõ¥Êí≠Èó¥${e.roomid}Ê£ÄÊµãÂºÇÂ∏∏: ${t.message}`)}if(0!==n)return void ra.debug(`Áõ¥Êí≠Èó¥${e.roomid}Ê£ÄÊµãÂ§±Ë¥•: ${n}-${i}`);if(null===r)return;const{excludeAward:o,includeAward:a}=$s.lottery,s=o.some((e=>r.award_name.match(e)));if(a.some((e=>r.award_name.match(e)))||!s){if(r.status===Xl&&!(r.gift_price>0))return 4===r.require_type&&(ra.info("ÊÇ®ËÉΩÂèçÈ¶àÁªô‰ΩúËÄÖËæìÂá∫‰∫Ü‰ªÄ‰πàÂêóÔºü"),ra.info(`${r.require_type}--${r.require_text}--${r.require_value}`),ra.info("‰πüËÆ∏ËøôÊ≠£ÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ„ÄÇ")),r.require_type===Vl&&Ts.userLevel>=r.require_value||r.require_type===Yl?r:r.require_type!==Ql||$s.lottery.skipNeedFollow?void 0:r}else ra.info(`Ë∑≥ËøáÂ±èËîΩÂ•ñÂìÅ: ${r.award_name}`)}async function ad(e,t=!0){try{const{id:r,gift_id:i,gift_num:o,award_name:a,uid:s,uname:c,require_type:u,require_text:f}=e;ra.info(`Â§©ÈÄâ‰∏ªÊí≠Ôºö„Äê${c}„Äë`),ra.info(`Â•ñÂìÅÔºö${a}`);const{code:l,message:d}=await(n={id:r,gift_id:i,gift_num:o},Zu.post("/xlive/lottery-interface/v1/Anchor/Join",{...n,csrf:$s.BILIJCT,csrf_token:$s.BILIJCT,visit_id:Mo(),platform:"pc"}));if(0!==l)return void ra.info(`Â§©ÈÄâÂ§±Ë¥•: ${l}-${d}`);if(ra.info("Â§©ÈÄâÊàêÂäü ‚àö"),u===Ql&&t){qo(td,s);(function(e){const t=(e=e.replace("ÂÖ≥Ê≥®‰∏ªÊí≠","")).split(/\s*\+\s*/);return t.shift(),t})(f).forEach((e=>qo(td,e)))}}catch(e){ra.info(`Â§©ÈÄâÂºÇÂ∏∏: ${e.message}`)}var n}async function sd(e,t,n=2){for(let r=1;r<=n;r++){const n=await id(e,t,r);for(const e of n)await ad(e),await Cs(300)}}async function cd(e){try{const{data:t,code:n}=await function(e){return Zu.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${e}`)}(e);if(0!==n)return;const{popularity_red_pocket:r}=t;if(!r)return;const{lot_id:i,lot_status:o}=r[0];if(2===o)return;return i}catch(e){ra.debug(`Ê£ÄÊµãÁ∫¢ÂåÖÂºÇÂ∏∏: ${e.message}`)}}async function ud(e,t,n=1){const r=await rd(e,t,n,"redPack"),i=[];for(const e of r){const t=await cd(e.roomid);t&&(i.push({uid:e.uid,uname:e.uname,lot_id:t,room_id:e.roomid}),await Cs(100))}return i}async function fd(e){try{const{lot_id:n,uid:r,uname:i,room_id:o}=e;ra.info(`Á∫¢ÂåÖ‰∏ªÊí≠Ôºö„Äê${i}„Äë`);const{code:a,message:s}=await(t={room_id:o,lot_id:n,ruid:r},Zu.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:$s.BILIJCT,csrf:$s.BILIJCT,visit_id:""}));if(0!==a)return void ra.info(`Á∫¢ÂåÖÂ§±Ë¥•: ${a}-${s}`);td.push(r),ra.info("Á∫¢ÂåÖÊàêÂäü ‚àö")}catch(e){ra.info(`Á∫¢ÂåÖÂºÇÂ∏∏: ${e.message}`)}var t}async function ld(e,t,n=2){for(let r=1;r<=n;r++){const n=await ud(e,t,r);for(const e of n)await vl({room_id:e.room_id,up_id:e.uid}),await Cs(100),await fd(e),await Cs(400)}}async function dd(){const e=[];return await async function t(n=1){try{var r;const{data:i,code:o,message:a}=await function(e=1,t=9){return Zu.get(`/xlive/web-ucenter/user/following?page=${e}&page_size=${t}`)}(n,9);if(0!==o)return void ra.info(`Ëé∑ÂèñÂÖ≥Ê≥®Áõ¥Êí≠Èó¥Â§±Ë¥•: ${o}-${a}`);const s=null===(r=i.list)||void 0===r?void 0:r.filter((e=>1===e.live_status));if(9===s.length&&n<i.totalPage)return e.push(...s),t(n+1);e.push(...s)}catch(e){ra.error(`Ëé∑ÂèñÂÖ≥Ê≥®Áõ¥Êí≠Èó¥ÂºÇÂ∏∏: ${e.message}`)}}(),e}async function pd(e){try{const{code:t,message:n,data:r}=await kf(e.roomid);if(0!==t)return void ra.debug(`Áõ¥Êí≠Èó¥${e.roomid}Ê£ÄÊµãÂ§±Ë¥•: ${t}-${n}`);if(null===r)return;if(r.status!==Xl)return;if(r.gift_price>0)return;return r}catch(t){return void ra.info(`Áõ¥Êí≠Èó¥${e.roomid}Ê£ÄÊµãÂºÇÂ∏∏: ${t.message}`)}}async function gd(){const{scanFollow:e}=$s.lottery;if(!e)return!0;try{ra.info("ÂºÄÂßãÊâ´ÊèèÂÖ≥Ê≥®ÁöÑ‰∏ªÊí≠");const e=await async function(){const e=await dd(),t=[];for(const n of e){const e=await pd(n);e&&t.push({...e,uid:n.uid,uname:n.uname}),await Cs(100)}return t}();for(const t of e)await ad(t,!1),await Cs(300);ra.info("ÂÖ≥Ê≥®ÁöÑ‰∏ªÊí≠Â§©ÈÄâÂÆåÊàê")}catch(e){ra.error(`ÂÖ≥Ê≥®ÁöÑ‰∏ªÊí≠Â§©ÈÄâÂºÇÂ∏∏: ${e.message}`)}return"only"!==e}async function md(){ra.info("----„ÄêÂ§©ÈÄâÊó∂Âàª„Äë----");const e=await gd();if(!e)return e;try{const e=await Gl();ra.info(`ÊúÄÂêé‰∏Ä‰∏™ÂÖ≥Ê≥®ÁöÑUP: ${e.uname}`);const t=await async function(){td=[];const{pageNum:e}=$s.lottery,t=await nd();for(const n of t)for(const t of n)await sd(t.areaId,t.parentId,e);return td}();ra.info("Êâ´ÊèèÂÆåÊàê");const n=[];await Wl(n,t,null==e?void 0:e.mid),await Hl(n),ra.info("ÁßªÂä®ÂÖ≥Ê≥®UPÂà∞ÂàÜÁªÑÊàêÂäü")}catch(e){ra.warn(`Â§©ÈÄâÊó∂ÂàªÂºÇÂ∏∏: ${e.message}`),ra.debug(e)}ra.info("ÁªìÊùüÂ§©ÈÄâÊó∂Âàª")}var hd=Object.freeze({__proto__:null,default:md,liveLottery:md});async function yd(e){try{const{code:t,message:n,data:r}=await function({session_type:e}={session_type:1}){return nf.get(`/session_svr/v1/session_svr/get_sessions?session_type=${e}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void ra.warn(`Ëé∑Âèñ‰ºöËØùÂ§±Ë¥•Ôºö${t}-${n}`);const{session_list:i}=r;if(i.length<=0)return;return i.filter((({unread_count:t,talker_id:n,is_follow:r,last_msg:i})=>{return e.find((e=>e.mid===n))&&t>0&&n===i.sender_uid&&1===r&&(o=i.timestamp,Date.now()-1e3*o<36e5);var o}))}catch(e){ra.error(`Ëé∑Âèñ‰ºöËØùÂºÇÂ∏∏Ôºö${e.message}`)}}async function _d(e){const t=await yd(e);await Cs(200);try{for(let e=0;e<t.length;e++){const n=t[e];await vd(n)}}catch(e){ra.error(`Êõ¥Êñ∞‰ºöËØùÂºÇÂ∏∏Ôºö${e.message}`)}t.length>=19&&await _d(e)}async function vd(e){switch($s.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:e,session_type:t}){return nf.post("/session_svr/v1/session_svr/remove_session",{talker_id:e,session_type:t,build:0,mobi_app:"web",csrf_token:$s.BILIJCT,csrf:$s.BILIJCT})}(e);break;case"read":await function({talker_id:e,session_type:t,ack_seqno:n}){return nf.post("/session_svr/v1/session_svr/update_ack",{talker_id:e,session_type:t,ack_seqno:n,build:0,mobi_app:"web",csrf_token:$s.BILIJCT,csrf:$s.BILIJCT},{headers:{origin:cs}})}(e)}await Cs(50)}async function wd(){ra.info("----„ÄêÂ§©ÈÄâÁ∫¢ÂåÖ„Äë----");try{const e=await Gl();ra.info(`ÊúÄÂêé‰∏Ä‰∏™ÂÖ≥Ê≥®ÁöÑUP: ${e.uname}`);const t=await async function(){td=[];const{pageNum:e}=$s.lottery,t=await nd();for(const n of t)for(const t of n)await ld(t.areaId,t.parentId,e);return td}();ra.info("Êâ´ÊèèÂÆåÊàêÔºåËé∑ÂèñÊñ∞ÂÖ≥Ê≥®ÁöÑUP");const n=[];await Wl(n,t,null==e?void 0:e.mid),ra.info("ÂºÄÂßãËØªÂèñÊ∂àÊÅØ"),await _d(n),ra.info("ÁßªÂä®ÂÖ≥Ê≥®UPÂà∞ÂàÜÁªÑ"),await Hl(n),ra.info("ÁßªÂä®ÂÖ≥Ê≥®UPÂà∞ÂàÜÁªÑÊàêÂäü")}catch(e){ra.warn(`Â§©ÈÄâÊó∂ÂàªÂºÇÂ∏∏: ${e.message}`),ra.debug(e)}ra.info("ÁªìÊùüÂ§©ÈÄâÁ∫¢ÂåÖ")}var bd=Object.freeze({__proto__:null,default:wd,liveRedPack:wd});var $d=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÁõ¥Êí≠‰∫≤ÂØÜÂ∫¶„Äë----");try{await Il(),ra.info("Áõ¥Êí≠‰∫≤ÂØÜÂ∫¶ÂÆåÊàê")}catch(e){ra.error(`Áõ¥Êí≠‰∫≤ÂØÜÂ∫¶: ${e.message}`)}}});let Td=0;async function Sd(){try{const{data:{list:e}}=await function(e=3394945){const t=(new Date).getTime();return Zu.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${e}`)}();if(!e)return;return e.filter((e=>{if(e.expire_at<=0)return!1;const t=(1e3*e.expire_at-(new Date).getTime())/864e5<2,n=![1,30607,30426,31531].includes(e.gift_id);return n&&t&&ra.info(`${e.gift_name} Âç≥Â∞ÜËøáÊúüËØ∑Â∞ΩÂø´ÊäïÂñÇ`),!n&&t}))}catch(e){if(Td++)return null;await Sd()}}async function Od(e){try{const{data:{live_room:t,name:n}}=await function(e){return ef.get(`x/space/acc/info?mid=${e}&jsonp=jsonp`)}(e);if(await Cs(),t.roomStatus)return{roomid:t.roomid,name:n}}catch{}}var Cd=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÊäïÂñÇËøáÊúüÈ£üÁâ©„Äë----");try{const e=await Sd();if(await Cs(),null==e||!e.length)return void ra.info("Ê≤°Êúâ2Â§©ÂÜÖËøáÊúüÁöÑÁÆÄÂçïÁ§ºÁâ©");const t=await async function(){const{gift:e}=$s,t=e.mids||[],n=()=>t.splice(Do(t.length-1),1)[0];for(;t.length;){const e=n(),t=await Od(e);if(t)return{mid:e,...t}}return await async function(){const{data:{count:e,items:t}}=await function(e=1,t=10){return e>10&&(e=10),Zu.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${e}&page_size=${t}`)}();if(await Cs(),!e)return;const n=t[Do(t.length-1)];return{mid:n.target_id,roomid:n.roomid||0,name:n.uname}}()}();if(!t)return void ra.info("Ê≤°ÊúâÊâæÂà∞ÊäïÂñÇÁõÆÊ†á");await async function({roomid:e,mid:t,name:n},r){for(const i of r){await Cs();try{const{code:r,message:o,data:a}=await Cf({roomid:e,ruid:t,bag_id:i.bag_id,gift_id:i.gift_id,gift_num:i.gift_num});if(0!==r){ra.warn(`Âêë[${n}]ÊäïÂñÇ[${i.gift_name}]Ôºå${o}`);continue}a.gift_list.forEach((e=>{ra.info(`ÊàêÂäüÁªô [${n}] ÊäïÂñÇ${e.gift_name}`)}))}catch{ra.debug(`Âêë[${n}]ÊäïÂñÇ[${i.gift_name}]ÔºåÂºÇÂ∏∏`)}}}(t,e)}catch(e){ra.info(`ÊäïÂñÇËøáÊúüÈ£üÁâ©ÂºÇÂ∏∏ ${e}`)}}});function kd(e){const t=e.level_info,n=t.current_level;if(n>=$s.coin.targetLevel&&(Ts.coinsTask=0),ra.info(`ÂΩìÂâçÁ≠âÁ∫ß: ${t.current_level}`),n>=6){const e=$s.function;e.shareAndWatch=!1,e.addCoins=!1,e.taskReward=!1,ra.info("Â∑≤ÁªèÊª°Á∫ßÔºå‰∏çÈúÄË¶ÅÂÜçÊäïÂ∏Å‰∫ÜÔºåÂÅö‰∏™ÁôΩÂ´ñÊÄ™Âêß")}else{const e=t.next_exp-t.current_exp;ra.info(`Ë∑ùÁ¶ªÂçáÁ∫ßËøòÈúÄË¶Å ${e} ÁªèÈ™åÔºåÈ¢ÑËÆ° ${function(e){const{targetCoins:t}=$s.coin;if(t<=0)return e/15;const n=10*t+15,r=e/n,i=Ts.money/(t-1);return r<i?Math.floor(r):(e-i*n)/25+i}(e).toFixed(2)} Â§©`)}}function Id(e){let t="";switch(Ts.vipType=e.vipType,Ts.vipStatus=e.vipStatus,e.vipType){case 0:t="Êó†Â§ß‰ºöÂëò";break;case 1:t="ÊúàÂ∫¶Â§ß‰ºöÂëò";break;case 2:t="Âπ¥Â∫¶Â§ß‰ºöÂëò"}0===e.vipStatus&&(t="Êó†Â§ß‰ºöÂëò"===t?t:t+"[Â∑≤ËøáÊúü]"),ra.info(`Â§ß‰ºöÂëòÁä∂ÊÄÅ: ${t}`)}async function Ed(e){try{var t;const{data:n}=await Xu.get("site/getCoin");ra.info(`ÁôªÂΩïÊàêÂäü: ${e.uname}`),ra.info(`Á°¨Â∏Å‰ΩôÈ¢ù: ${n.money||0}`),Ts.nickname=e.uname,Ts.money=n.money||0,Ts.userLevel=e.level_info.current_level,Ts.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0,kd(e),Id(e)}catch(e){ra.error(`Ëé∑ÂèñÁ°¨Â∏Å‰ø°ÊÅØÂºÇÂ∏∏: ${e.message}`),ra.debug(e)}}var Pd=Object.freeze({__proto__:null,setVipStatus:Id,default:async function(){ra.info("----„ÄêÁôªÂΩï„Äë----");const{data:e,message:t,code:n}=await of();if(0!==n)throw ra.error(`ÁôªÂΩïÈîôËØØ ${n} ${t}`),new Error(t);if(!e.isLogin)throw new Error("Êé•Âè£ËøîÂõû‰∏∫Êú™ÁôªÂΩï");await Cs(),await Ed(e)}});const xd=new na({console:"debug",file:"warn",push:"warn",payload:Ts.nickname},"live");async function jd(e=400){for(let t=e/6;t>0;t--){if((await Ad()).duration>360)break;await Ld()}}async function Ld(){const e=await async function(){try{const{data:e,code:t,message:n}=await Zu.get(`activity_php/v1/Famine/recommendAnchors?_=${(new Date).getTime()}`);return 0!==t?void xd.warn(`Ëé∑ÂèñÊ¥ªÂä®‰∏ªÊí≠Â§±Ë¥• ${t} ${n}`):e.anchor_list}catch(e){xd.error(e),xd.error(`Ëé∑ÂèñÊ¥ªÂä®ÁöÑ‰∏ªÊí≠ÂºÇÂ∏∏ ${e.message}`)}}();if(!e||0===e.length)return;const t=Wo(e);xd.info(`Ëé∑ÂèñÂà∞‰∏ªÊí≠Ôºö${t.nickname} ÊàøÈó¥Âè∑Ôºö${t.room_id}`);const n=xl();await async function(e,t){for(let n=t;n>0;n--)await Rd(e),await Cs(6e4)}({up_id:t.uid,room_id:t.room_id,...n},10)}async function Rd(e){try{const{code:t,message:n}=await vl(e);if(0!==t)return void xd.warn(`Áõ¥Êí≠Èó¥ÂøÉË∑≥Â§±Ë¥• ${t} ${n}`);xd.info("Áõ¥Êí≠Èó¥ÂøÉË∑≥ÊàêÂäü")}catch(e){xd.error(e),xd.error(`Áõ¥Êí≠Èó¥ÂøÉË∑≥ÂºÇÂ∏∏ ${e.message}`)}}async function Ad(){try{const{data:e,code:t,message:n}=await Zu.get(`activity_php/v1/Famine/userWatchTime?_=${(new Date).getTime()}`);return 0!==t?void xd.warn(`Ëé∑ÂèñËßÇÁúãÊó∂Èó¥Â§±Ë¥• ${t} ${n}`):e}catch(e){xd.error(e),xd.error(`Ëé∑ÂèñËßÇÁúãÊó∂Èó¥Â§±Ë¥• ${e.message}`)}}(async()=>{await jd(30)})();var Nd=Object.freeze({__proto__:null,default:async function(){ra.info("----„ÄêÈ••ËçíÁõ¥Êí≠Èó¥ÊåÇÊú∫„Äë----");try{await jd($s.activity.liveFamineTime),ra.info("È••ËçíÁõ¥Êí≠Èó¥ÊåÇÊú∫ÂÆåÊàê")}catch(e){ra.error(`È••ËçíÁõ¥Êí≠Èó¥ÊåÇÊú∫: ${e.message}`)}}});
